\documentclass[12pt,svgnames,table]{beamer}
\usetheme{onerajdt}
\usepackage[utf8x,utf8]{inputenc}
\usepackage{tikz}
\usetikzlibrary{decorations.pathmorphing}
\usepackage{xcolor}
\usepackage{amsmath,amsfonts,amsthm, amssymb}
\usepackage[babel=true]{csquotes}
\usepackage{etoolbox}
\usepackage{dsfont}
\usepackage{chngpage}


\usepackage{graphics} %% TOUT NEW!!
\usepackage{pgfplots} %% TOUT NEW!!  virer si pbm

%\usepackage{txfonts}
%\usepackage{MnSymbol} % symbol independent
\newcommand{\paren}[1]{\left( \left. #1 \right. \right)} 
\newcommand{\croch}[1]{\left[ \left. #1 \right. \right]} 
\newcommand{\set}[1]{\left\{ \left. #1 \right. \right\}}
\newcommand{\sachant}{\, \right| \left. \,}
\newcommand{\nico}[1]{ }
% Modifiez ou necessaire:
% titre de these/topo

\title{Exploiting Imprecise Information Sources\\
in Sequential Decision Making Problems\\
under Uncertainty.}

\normalsize
\author{\vspace{0.5cm} Ph.D defense \textbf{N.Drougard}}
% X=annee de these, Y=departement
\def\aboutauthor{\vspace{0.2cm}\hspace{-6.4cm}doctoral school: EDSYS, \\
\vspace{0.1cm}\hspace{-6cm}institution: ISAE--SUPAERO,\\
\vspace{0.1cm}\hspace{-4.15cm}laboratory: ONERA--The French Aerospace Lab.}
% directeur de these
%\def\directeur{Toulouse}
% encadrant; s'il n'y a pas d'encadrant, veuillez commenter la ligne ci-dessous
%\def\encadrant{DCSD}


% Debut du documment
\begin{document}

% la premiere page
{
\usebackgroundtemplate{\includegraphics[width=\paperwidth,height=\paperheight]{beamer-onera-background}} 
\begin{frame}[plain]
	\titlepage
\end{frame}
}

% plan
\section*{}
\begin{frame}
  \frametitle{Plan}
  \tableofcontents[section=1,hidesubsections]
\end{frame}

\AtBeginSection[]
{
  \frame<handout:0>
  {
    \frametitle{Plan}
    \tableofcontents[currentsection,hideallsubsections]
  }
}

\AtBeginSubsection[]
{
  \frame<handout:0>
  {
    \frametitle{Plan}
    \tableofcontents[sectionstyle=show/hide,subsectionstyle=show/shaded/hide]
  }
}


% La premiere planche
% Ci-dessous c'est a vous de remplir
\section{Context}
\begin{frame}
\frametitle{\insertsection} 
\framesubtitle{\footnotesize Partially Observable Markov Decision Processes (POMDPs)} 
\normalsize
\vspace{-0.5cm}
\begin{tikzpicture}[scale=0.9,transform shape]
\vspace{0.2cm}
\visible<1->{
\node (pomdp) at (3.5,5.6) {\textbf{POMDP:} model for autonomous robotics};
\node (rpomp) at (-1,4.7) {\includegraphics[scale=0.9]{robot_pompier}};
\node (bli) at (0,6.5) {};
}
\visible<2->{
\node (pomdp3) at (4.15,5.05) {\color{DodgerBlue!70}{$s \in \mathcal{S}$}: \color{black}{\textbf{system state}};};
\node (t1) at (2,5) {};
\node (r1) at (-2.3,5.5) {};
\node (r11) at (1,4.5) {};
\draw[->,>=latex,color=DodgerBlue!70,thick] (t1) to (r1);
\draw[->,>=latex,color=DodgerBlue!60,thick] (t1) to[bend right] (r11);
}
\visible<3->{
\node (pomdp4) at (4.85,4.45) {\color{MediumAquamarine}{$o \in \mathcal{O}$:} \color{black} \textbf{system observations};};
\node (t2) at (2,4.4) {};
\node (r2) at (-2.3,5.05) {};
\draw[->,>=latex,color=MediumAquamarine,thick] (t2) to[bend left] (r2);
}
\visible<4->{
\node (pomdp5) at (4.4,3.85) {\color{MediumPurple}{$a \in \mathcal{A}$:} \color{black} \textbf{agent's actions};};
\node (t3) at (2,3.9) {};
\node (r3) at (-2,4.2) {};
\draw[->,>=latex,color=MediumPurple,thick] (t3) to[bend left] (r3);
}
\visible<12->{
\node (pomdp6) at (3.1,3.25) {\color{red}{$b$} \textbf{belief.}  \color{black}};
}
\end{tikzpicture}

\begin{tikzpicture}[scale=0.8,transform shape]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%vis1: state
%%%%%%%%%%%%%%
%%%%%%%%%%%%%%
%\node (bli) at (0,0.5) {};
\visible<5->{
\tikzstyle{mvertex}=[circle,fill=black!60,minimum size=30pt,inner sep=0pt]
\node[mvertex] (state1t) at (3,0) {$s_t$};
}
%vis2 action
%%%%%%%%%%%%%%
%%%%%%%%%%%%%%
\visible<6->{
\node[fill=black!30] (action) at (6.3,-1.7) {$a_t$};
}
%vis3: next state
%%%%%%%%%%%%%%
%%%%%%%%%%%%%%
\visible<7->{
\node[mvertex] (state2t) at (7.7,0) {$s_{t+1}$};
\tikzstyle{bvertex}=[circle,fill=red!60,minimum size=30pt,inner sep=0pt]
%1->2
\draw[->,>=latex] (state1t) -- (state2t);
\draw[->,>=latex] (action) -- (state2t);
\node (pisasp) at (6,-0.3) {$\textbf{p} \hspace{-0.05cm} \paren{ \hspace{-0.05cm} s_{t+1} \hspace{-0.05cm} \sachant \hspace{-0.05cm} s_{t}, \hspace{-0.05cm} a_t \hspace{-0.05cm} }$};
}

%vis4: observation
%%%%%%%%%%%%%%
%%%%%%%%%%%%%%
\visible<8->{
\node[fill=black!30] (hobserv2) at (10.2,-3.3) {$o_{t+1}$};
\draw[->,>=latex] (state2t) to (hobserv2);
\draw[->,>=latex] (action) to  (hobserv2);
\node (pisvshaoh2) at (8.4,-2) [rotate=330] {$\textbf{p} \paren{ o_{t+1} \sachant s_{t+1},a_{t} }$};
}

%vis5: rewards:
\visible<9->{
\tikzstyle{rvertex}=[fill=yellow!60,minimum size=10pt,inner sep=0pt]
\node[rvertex] (Rt) at (6.9,-4) {$r(s_t,a_t)$};
\node[rvertex] (Rtbis) at (7.6,-4.4) {\textbf{reward}};
\draw[->,decorate,decoration={snake,amplitude=.4mm,segment length=2mm,post length=1mm}] (state1t) -- (Rt); 
\draw[->,decorate,decoration={snake,amplitude=.4mm,segment length=2mm,post length=1mm}] (action) -- (Rt); 
}

%visFIN:
%%%%%%%%%%%%%%
%%%%%%%%%%%%%%
\visible<10->{
%s
\node (state0) at (0,0) {};
\node (state3) at (13,0) {};
\node (state0bis) at (0,-1.8) {};
\node (state3bis) at (13,-0.5) {};
\node (obs3) at (13,-2.3) {};
\draw[->,>=latex,dashed] (state0) -- (state1t);
\draw[->,>=latex,dashed] (state2t) -- (state3);
\node (pisasp2) at (1.1,-0.3) {$\textbf{p} \hspace{-0.05cm} \paren{ \hspace{-0.05cm} s_{t} \hspace{-0.05cm} \sachant \hspace{-0.05cm} s_{t-1}, \hspace{-0.05cm} a_{t-1} \hspace{-0.05cm} }$};
%a
\node[fill=black!30] (action0) at (1.6,-1.7) {$a_{t-1}$};
\draw[->,>=latex] (action0) -- (state1t);
\node[fill=black!30] (actiontp1) at (11.5,-1.7) {$a_{t+1}$};
\draw[->,>=latex,dashed] (actiontp1) -- (state3bis);
\draw[->,>=latex,dashed] (actiontp1) -- (obs3);
%o
\node (pisvshaoh1) at (3.9,-2.15) [rotate=330] {$\textbf{p} \paren{ o_{t} \sachant s_t,a_{t-1} }$};
\node[fill=black!30] (hobserv1) at (5.5,-3.3) {$o_{t}$};
\draw[->,>=latex] (state1t) to (hobserv1);
\draw[->,>=latex] (action0) to  (hobserv1);
%r
\node[rvertex] (Rt2) at (11.8,-4) {$r(s_{t+1},a_{t+1})$};
\draw[->,decorate,decoration={snake,amplitude=.4mm,segment length=2mm,post length=1mm}] (state2t) -- (Rt2); 
\draw[->,decorate,decoration={snake,amplitude=.4mm,segment length=2mm,post length=1mm}] (actiontp1) -- (Rt2); 

\node[rvertex] (Rt3) at (2,-4) {$r(s_{t-1},a_{t-1})$};
\draw[->,decorate,decoration={snake,amplitude=.4mm,segment length=2mm,post length=1mm}] (state0bis) -- (Rt3); 
\draw[->,decorate,decoration={snake,amplitude=.4mm,segment length=2mm,post length=1mm}] (action0) -- (Rt3);
}

\visible<11->{
	\coordinate (A) at (0,-1); 
	\coordinate (B) at (13,-1); 
	\coordinate (C) at (13,-3.7);
	\coordinate (D) at (0,-3.7); 
	\fill[red!20,opacity=0.5] (A) -- (B) -- (C) -- (D) -- cycle;
}

%visFINFIN belief
%%%%%%%%%%%%%
%%%%%%%%%%%%%
\visible<12->{
\node (bel0) at (1,1) {};
\node (bel3) at (13,1) {};
\node[bvertex] (bel2) at (10.5,1) {$b_{t+1}$};
\node[bvertex] (bel1) at (5.8,1) {$b_{t}$};
\node (pbb) at (8.25,0.75) [color=red,thick] {$\textbf{p} \paren{ b_{t+1} \sachant b_t,a_{t} }$};
\draw[->,>=latex,color=red,thick] (bel1) to (bel2);
\draw[->,>=latex,color=red,dashed,thick] (bel0) to (bel1);


\draw[->,>=latex,color=red,dashed,thick] (bel2) to (bel3);

%\node (procBel) at (12.7,0.1) [color=red] {croyance $b_{t+1}$ telle que};
%\node (procBelp) at (12.8,-0.4) [color=red] {$b_{t+1}(s_{t+1}) = \textbf{p} \paren{ s_{t+1} \sachant history }$.};
%\node (procBel2) at (12.8,-1.2) [color=red] {\textbf{règle de Bayes} $\rightarrow$ le calcul };
%\node (procBel3) at (12.8,-1.7) [color=red] { utilise $o_{t+1}$, $a_t$ et $b_t$ };

\draw[->,>=latex,color=red,thick] (hobserv2) to[bend left] (bel2);
\draw[->,>=latex,color=red,thick] (action) to (bel2);
\draw[->,>=latex,color=red,thick] (hobserv1) to[bend left] (bel1);
\draw[->,>=latex,color=red,thick] (action0) to (bel1);
}

\end{tikzpicture}

\end{frame}











\begin{frame}
\definecolor{bblue}{rgb}{0,0.4,0.75}
	\frametitle{\insertsection} 
	\framesubtitle{\footnotesize belief state, strategy, criterion.}
\center \textbf{POMDP:} $\langle \mathcal{S}, \mathcal{A}, \mathcal{O}, T, O, r, \gamma \rangle$,
\begin{itemize}
\item \textbf{transition} function $T(s,a,s') = \textbf{p} \paren{ s' \sachant s, a }$;
\item \textbf{observation} function $O(s',a,o') = \textbf{p} \paren{ o' \sachant s', a }$.
\end{itemize}
\vspace{1cm}
\visible<2->{
\[ { \textbf{belief state: }  \color{bblue} \displaystyle b_{t}(s) = \mathbb{P} \paren{ s_t = s \sachant a_0, o_1, \ldots, a_{t-1}, o_t  } } \]
}
\visible<3->{
\begin{exampleblock}{\textbf{probabilistic} belief update}
\begin{center}
$ b_{t+1}(s') %= u(b_t,a,o') 
\propto \textbf{p} \paren{ o' \sachant s',a} \cdot \sum_{s \in \mathcal{S}} \textbf{p} \paren{ s' \sachant s,a} \cdot b_t(s)  $
\end{center}
\end{exampleblock}
\vspace{-0.15cm}
\visible<4->{
\begin{block}{action choices: strategy $\delta(b_t) = a_t \in \mathcal{A}$}
\begin{center}
maximizing $ \displaystyle \mathbb{E}_{s_0 \sim b_0} \croch{ \sum_{t=0}^{+ \infty} \gamma^t \cdot r\Big(s_t,\delta(b_t)\Big) }$, $0<\gamma<1$. 
\end{center}
\end{block}
}
}

\end{frame}













\begin{frame}
\frametitle{Flaws of the POMDP model}
\framesubtitle{\footnotesize POMDPs in practice}
\begin{itemize}
\item optimal strategy computation $\geqslant$ \textbf{PSPACE};
\end{itemize}
\begin{itemize}
%\rightarrow raisonnement sur l'ensemble des probabilités $b \in \mathcal{B}_{\mathcal{S}}$
\item probabilities are \textbf{imprecisely known} in practice;
% \textit{ex:} $o \in \mathcal{O}$ sorties d'algorithmes de vision artificielle:\\
%fonction $O$ dépendante des datasets; 
\end{itemize}
%grande variabilité d'images $\rightarrow$ classifieur dur à extraire;\\
%$\# \mathcal{O}$ plus grand $\rightarrow$ POMDP plus complexe.
%\item définition de la fonction d'observation $O$?
\begin{itemize}
% ignorante?\\
%quantification si imprécision?
%\end{itemize}
%\begin{itemize}
\item agent's \textbf{ignorance} not taken into account.
\end{itemize}
%mission d'observation $+$ situation inconnue;\\
%paramètres ``situation très peu probable''.
\end{frame}






\begin{frame}
	\frametitle{\insertsection} 
	\framesubtitle{\footnotesize practical issues: Complexity, Vision and Initial Belief.}

\begin{itemize}
\item \textbf{strategy computation $\geqslant$ PSPACE-complete:}
\end{itemize}
\visible<2->{
$\rightarrow$ optimality for \enquote{small} ou \enquote{structured} POMDPs; \\
$\rightarrow$ approximate computations (no optimality garantee).}
\visible<3->{
\begin{itemize}
\item \textbf{Computer Vision}, statistical learning: 
$\textbf{p} \paren{ o' \sachant s', a }$
\end{itemize}
}
%probabilités $\textbf{p} \paren{ o' \sachant s', a }$
\visible<4->{
%$\rightarrow$ dépendante de l'ensemble des images d'entra\^inement; \\
$\rightarrow$  wide picture variability? $\Rightarrow$ hard extraction of a classifier; \\
$\rightarrow$ more observations? $\Rightarrow$ more complex POMDP.
\vspace{-0.3cm}
}
\visible<3->{
\vspace{-0.3cm}
\includegraphics[scale=0.5]{fig2}
}
\visible<5->{
\begin{itemize}
\item \textbf{Initial belief} $b_0$ (\textit{prior} information on the system state). 
\end{itemize}
}
\visible<6->{
uniform $=$ subjectif, mix up with frequencies!\\
}
\visible<7->{
\begin{block}{}
\textbf{Qualitative Possibility Theory:}\\ 
$\rightarrow$ simplification, ignorance and imprecision modeling.
\end{block}
}
\end{frame}









\begin{frame}
\definecolor{bblue}{rgb}{0,0.4,0.75}
\frametitle{Why model ignorance?}
\framesubtitle{\footnotesize knowledge is not always encouraged with POMDPs}
\begin{itemize}
\item initial belief deterministic $s_0=s_A$.
\end{itemize}
\vspace{0.1cm}
\begin{tikzpicture}

\tikzstyle{avertex}=[circle,fill=green!30,minimum size=20pt,inner sep=0pt]
\tikzstyle{vertex}=[circle,fill=black!30,minimum size=20pt,inner sep=0pt]

\visible<2->{
\node (L) at (-1,0) {};
\node (R) at (8.5,0) {};
\draw[thick,dashed,color=black!30] (L) to (R);
}

\node[vertex] (sA) at (0,0) {$s_A$};
\node[fill=bblue!30] (b0) at (-0.7,-0.8) {$b_0(s_A) = 1$};

\visible<2->{
\node[avertex] (a1) at (1,1.5) {$a'$};
\node[vertex] (sB) at (3,2) {$s_B$};
\node[fill=bblue!30] (b1A) at (5,2) {$b_1(s_B) = 0.5$};
\node[vertex] (sC) at (3,1) {$s_C$};
\node[fill=bblue!30] (b1B) at (5,1) {$b_1(s_C) = 0.5$};
\node[fill=yellow] (rA) at (8,2) {$r(s_B)=10$};
\node[fill=yellow] (rB) at (8,1) {$r(s_C)=0$};
\draw[->,>=latex,thick,color=red] (sA) to (sB);
\draw[->,>=latex,thick,color=red] (sA) to (sC);
}
\visible<3->{
\node[avertex] (a2) at (1,-1.5) {$\tilde{a}$}; 
\node[vertex] (sD) at (3,-1) {$s_D$};
\node[fill=bblue!30] (b1C) at (5,-1) {$b_1(s_D) = 1$};
\node[fill=yellow] (rC) at (8,-1) {$r(s_D)=5$};
\draw[->,>=latex,thick,color=blue] (sA) to (sD);
}
\end{tikzpicture}
\visible<4->{
\vspace{-0.5cm}
\begin{itemize}
\item $ \set{ s_B, s_C, s_D }$ $\xrightarrow{\mbox{\scriptsize deterministic}} s_E$, $r(s_E)=0$.
\end{itemize}
}
\visible<5->{
\begin{block}{}
 $ \displaystyle \mathbb{E}_{s_0 \sim b_0} \croch{ \sum_{t=0}^{+ \infty} \gamma^t \cdot r(s_t) \sachant a_0 = { \color{red} \tilde{a} } \mbox{ or } { \color{red} a' } } = r(s_0) + 5 \gamma$. \\
\textbf{ the safe action is not prefered.}
\end{block}
}
\end{frame}


\begin{frame}
\frametitle{Qualitative Possibility Theory}
\framesubtitle{\footnotesize an hybrid model with possibilistic belief states}
\begin{block}{Qualitative Possibility Theory}
\begin{itemize}
\item \textbf{simplification}/\textbf{imprecision} taken into account,\\
{\color{red} BUT frequentist information lost};
\item \textbf{ignorance} modeling;
\item possibilistic belief states already studied: $\pi$-POMDP (Sabbadin UAI98, Drougard UAI13, AAAI14).
\end{itemize}
\end{block}
\visible<2->{
\begin{itemize}
\item \textbf{POMDP with possibilistic belief states}\\ 
$\rightarrow$ heuristic for solving POMDPs; \\
$\rightarrow$ results in a standard MDP.\\
%\item traduction PSCACE $\rightarrow$ EXPTIME car $\# \Pi_S \sim \# \mathcal{L}^{\# \mathcal{S}}$.
\end{itemize}
}
\visible<3->{
\begin{alertblock}{}
\begin{itemize}
\item {\color{red} defined distributions $\pi$}:\\
%\begin{enumerate}
%\item 
$\mathbb{P} \rightarrow \pi$ transformations: 
pignistic, specific, $\ldots$
%\item %probabilités estimées avec garantie faible\\ 
%POMDP décrit plus fidèlement par $\pi$.
%\end{enumerate} 
\end{itemize}
\end{alertblock}
}
\end{frame}

\begin{frame}
\frametitle{Qualitative Possibility Theory}
\framesubtitle{\footnotesize presentation}
\vspace{0.15cm}
$1 = l_1 > l_2 > \ldots > l_{\# \mathcal{L}} = 0$ form the \textbf{finite scale} 
$\mathcal{L}$.
\begin{exampleblock}{}	
\flushleft events $e \subset \Omega$ (universe) \\ 
\centering
\textbf{sorted} using possibility \textbf{degrees} $\pi(e) \in \mathcal{L}$, \\
	$\neq$ \\
	\textbf{quantified} with \textbf{frequencies} $\textbf{p}(e) \in \croch{0,1}$ (probabilities).
	\end{exampleblock}
\visible<2->{
	\begin{block}{}
	$e_1 \neq e_2$, $2$ events $\subset \Omega$ 
	\begin{itemize}
	\item $ \pi(e_1) < \pi(e_2) $ $\Leftrightarrow$ \enquote{$e_1$ 
is less plausible than $e_2$}; \\
	\end{itemize}	
	\end{block}
}
	\visible<3->{ 
	\begin{alertblock}{}
	\centering
	{ \color{red} \hspace{1.2cm} Probability ($\mathbb{P}$) \hspace{0.3cm} / \hspace{0.1cm} Possibility ($\Pi$)}:
	\vspace{0.1cm}
	{\renewcommand{\arraystretch}{1.2} %donne la distance entre les lignes%
	{\setlength{\tabcolsep}{0.15cm} %donne la distance entre les collones%
	\resizebox{11cm}{!}{
	\begin{tabular}{!{\vrule width 2pt}c!{\vrule width 2pt}c!{\vrule width 1pt}c!{\vrule width 2pt}}
	\noalign{\hrule height 2pt} 
 	$e_1$ or $e_2$ &  $ \textbf{p}(e_1) + \textbf{p}(e_2 \cap 
\overline{e_1}) $  & $ \max \set{ \pi(e_1), \pi(e_2)}$ \\
	\noalign{\hrule height 2pt}  	
	$e_1$ and $e_2$ & $ \textbf{p}(e_1). \textbf{p} \paren{e_2 \sachant e_1 } $  & $\min \set{\pi(e_1), \pi(e_2 \sachant e_1)  }$ \\
	\noalign{\hrule height 2pt}  	
	\end{tabular}
	}
	}
	}
	\end{alertblock}	
	}
\end{frame}


\section{Mixed-Observability and unbounded mission durations}
\begin{frame}
\frametitle{Possibilistic models: \\ $\pi$-MOMDPs}
\vspace{-0.3cm}
possibilistic POMDPs ($\pi$-POMDPs): \textit{Sabbadin UAI-98}.
\begin{itemize}
\item finite belief space \color{red} $\# \mathcal{B} = \# \mathcal{L}^{\# \mathcal{S}} - (\# \mathcal{L}-1)^{\# \mathcal{S}}$ \color{black} 
\end{itemize}

\visible<2->{
\textbf{contribution (UAI13):}
\vspace{-0.6cm}
\begin{figure}\centering
\begin{tikzpicture}[scale=0.8,transform shape]

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% macro states
\tikzstyle{mvertex}=[circle,fill=black!15,minimum size=75pt,inner sep=0pt]
\node[mvertex] (state1) at (2.3,0) {};
\node [font=\huge] (state1t) at (2.3,1) {$s_t$};
\node[mvertex] (state2) at (8,0) {};
\node [font=\huge] (state2t) at (8,1) {$s_{t+1}$};
%0
\node (state0) at (-0.4,0) {};
%3
\node (state3) at (10.7,0) {};
\node (rien) at (-2,0) {};


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% possibilités
\node (pisasp) at (5.3,0.3) {$\pi \paren{ s_{t+1} \sachant s_{t},a_t }$};
\node (pisvshaoh1) at (4.1,-1.1) [rotate=350] {$\pi \paren{ o_{t} \sachant s_t,a_{t-1} }$};
\node (pisvshaoh2) at (10,-1.1) [rotate=350] {$\pi \paren{ o_{t+1} \sachant s_{t+1},a_{t} }$};

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%vstates
\tikzstyle{vertex}=[circle,fill=black!30,minimum size=28pt,inner sep=0pt]
%1
\node[vertex] (vstate1) at (2.3,0.3) {$s_{v,t}$};
%2
\node[vertex] (vstate2) at (8,0.3) {$s_{v,t+1}$};
%\node [font=\huge] (state2t) at (8,0.9) {$s_{t+1}$};

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%hstates
%1
\tikzstyle{hvertex}=[circle,fill=black!60,minimum size=28pt,inner sep=0pt]
\node[hvertex] (hstate1) at (2.3,-0.7) {$s_{h,t}$};
%2
\node[hvertex] (hstate2) at (8,-0.7) {$s_{h,t+1}$};


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%action
\node[fill=black!30] (action) at (6.3,-0.9) {$a_t$};
\node[fill=black!30] (action0) at (0.3,-0.9) {$a_{t-1}$};

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% observations
%1
\node[fill=black!30] (hobserv1) at (4.1,-1.9) {$o_{t}$};
%2
\node[fill=black!30] (hobserv2) at (9.9,-1.9) {$o_{t+1}$};


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%ARROWS

%S
%0->1
\draw[->,>=latex,dashed] (state0) -- (state1);
%2->3
\draw[->,>=latex,dashed] (state2) -- (state3);
%1->2
\draw[->,>=latex] (state1) -- (state2);


%SV

% arrows sv->oh
%1
\draw[->,>=latex] (vstate1) to[bend left] (hobserv1);
%2
\draw[->,>=latex] (vstate2) to[bend left] (hobserv2);


%SH

% arrows sh->oh
%1
\draw[->,>=latex] (hstate1) to (hobserv1);
%2
\draw[->,>=latex] (hstate2) to (hobserv2);

%A
% a->s
%1
\draw[->,>=latex] (action) -- (vstate2);
\draw[->,>=latex] (action) -- (hstate2);
%0
\draw[->,>=latex,dashed] (action0) -- (vstate1);
\draw[->,>=latex,dashed] (action0) -- (hstate1);

% a->oh
%1
\draw[->,>=latex] (action) to[bend right]  (hobserv2);
%0
\draw[->,>=latex] (action0) to[bend right]  (hobserv1);

%\node (probao1) at (4,-2.2) [rotate=350] {$ \pi \paren{ o_{h,t} \sachant s_t, a_{t-1}}$};
%\node (probao2) at (11,-2.5) [rotate=350] {$ \pi \paren{ o_{h,t+1} \sachant s_{t+1}, a_{t}}$};
%\node (probas) at (8.9,0.5) [rotate=355] {$ \pi \paren{s_{t+1} \sachant s_t,a_{t}}$};

\end{tikzpicture}
\end{figure}
\vspace{-0.5cm}
\textbf{Mixed-Observability:} system state $s \in {\color{blue} \mathcal{S} = \mathcal{S}_v  \times \mathcal{S}_h} $ \\ 
\textit{i.e.} state $s \hspace{0.05cm} = \hspace{0.05cm} $ visible component $s_v$ \hspace{0.05cm} $\&$ \hspace{0.05cm} hidden component $s_h$. \\ 
}
\visible<3->{
\vspace{-0.2cm}
\begin{itemize}
\item beliefs are only over $\mathcal{S}_h$ (component $s_v$ observed), \\ 
\item computations on $\mathcal{X} = \mathcal{S}_v \times \mathcal{B}_h$ whose size is \\ 
\hspace{2cm} \color{red} $\# \mathcal{X} = \# \mathcal{S}_v \hspace{-0.05cm} \cdot \hspace{-0.05cm} (\hspace{-0.05cm} \# \mathcal{L}^{\# \mathcal{S}_h} \hspace{-0.1cm} - \hspace{-0.1cm} (\# \mathcal{L}-1)^{\# \mathcal{S}_h} ) \ll \# \mathcal{B}$. \color{black}
\end{itemize}
}
\end{frame}

\begin{frame}
\frametitle{$\pi$-MOMDPs in practice}
\vspace{0.1cm}
\textbf{contribution (UAI13): Infinite Horizon}
\begin{block}{Dynamic Programming scheme: $\#$ iterations $<\# \mathcal{X}$.}
$\forall x \in \mathcal{X}$, $V_0(x) = \mu(x)$ \textbf{preference}, 
\visible<2->{
and, until convergence,
$\bullet V_{i+1}(x) = \displaystyle \max_{a \in \mathcal{A}} \max_{x' \in \mathcal{X}} \min \set{ \pi \paren{ x' \sachant x , a} , V_i(x') }$,}
\visible<3->{
 \mbox{ and } \\
$\mbox{if } V_{i+1}(x) \hspace{-0.1cm} > \hspace{-0.1cm} V_i(x), \delta(x) \hspace{-0.1cm} = \hspace{-0.1cm} \displaystyle \operatorname*{argmax}_{a \in \mathcal{A}} \hspace{-0.05cm} \max_{x' \in \mathcal{X}} \hspace{-0.05cm} \min \hspace{-0.1cm} \set{ \hspace{-0.1cm} \pi \paren{ x' \sachant x , a} , \hspace{-0.1cm} V_i(x') \hspace{-0.1cm} }$.}
\end{block}
\vspace{-0.3cm}
\visible<4->{
\begin{exampleblock}{Recognition mission: robot on a grid $g \times g$, $2$ targets $T1$, $T2$.}
\begin{minipage}{0.35\linewidth}
- \textbf{goal:} reach the\\ 
object $A$ = $T1$ or $T2$; \\
- noisy observations\\ 
of the targets natures:
$\textbf{p} \paren{ o' \sachant s',a }$.
%The possibilistic belief update \ref{possBelUpdate}
%only takes into account 
%more reliable observations.
%On the contrary a probabilistic belief is modified at each step. 
\end{minipage}
\hspace{-0.3cm}
\begin{minipage}{0.45\linewidth}
\includegraphics[width=.65\linewidth]{robotgrid.pdf} 
\includegraphics[width=.85\linewidth]{courbe1.pdf}
\end{minipage} \\
Actually, misperception in the error zone is: 
$P_{bad} > \frac{1}{2}$.
\end{exampleblock}
}
\end{frame}

\section{Factored $\pi$-MOMDP and computations with ADDs }
\begin{frame}
\frametitle{Factorization and symbolic solver}
	\centering
	\begin{exampleblock}{}
	\textbf{contribution (AAAI14):} factored $\pi$-MOMDP \\ 
$\Leftrightarrow$ state space $\mathcal{X} = \mathcal{S}_v \times \mathcal{B}_h =$ 
Boolean variables ($X_1,\ldots,X_n$) \\ 
	\hspace{1cm} $+$ independence assumptions $\Leftarrow$ graphical model.
	\end{exampleblock}
	\vspace{0.2cm}
	\includegraphics[scale=1]{factMDPdid.pdf} \\
	\visible<2->{
	%\vspace{0.5cm}
	\begin{alertblock}{}
	\centering
	\begin{minipage}{0.75\linewidth}
	\begin{itemize}
	\item transition functions $T_i^a = \pi \paren{X_i' \sachant parents(X_i'),a}$ \\ 
	\textbf{represented by Algebraic Decision Diagrams (ADD)}. \\
	(SPUDD -- \textit{Hoey et al., UAI-99}).
	\end{itemize}
	\end{minipage}
	\hspace{0.2cm}
	\begin{minipage}{0.2\linewidth}
	\includegraphics[scale=0.55]{tabADD} \\
	\scriptsize example of ADD
	\end{minipage} 
	\end{alertblock}
	}
\end{frame}


\begin{frame}
\frametitle{Solver $\pi$-MOMDP résultant: PPUDD}
\centering
\begin{block}{}
\begin{itemize}
\item probabilistic model: $+$ and $\times$ $\Rightarrow$ new values created, \\ 
number of ADDs leaves \textbf{potentially huge}.
\item possibilistic model: $\min$ and $\max$ $\Rightarrow$ values $\in \mathcal{L}$ finite, 
number of leaves bounded, \textbf{ ADDs \textbf{smaller}}.
\end{itemize}
\end{block}
\vspace{-0.6cm}
\begin{figure}
\begin{tikzpicture}
		\visible<2->{
	\node (PPUDD) at (2.5,15) {\textbf{PPUDD: Possibilistic Planning Using Decision Diagrams}};
	
	\node (algo) at (0,12.7) {\includegraphics[scale=0.75]{algo2.pdf}};
}	
	\visible<3->{	
	\node (blabla1) at (5.7,14.2) {factorization};
	\node (blabla12) at (5.7,13.6) {{\color{blue!80} $\Rightarrow$ dynamic programming}};
	\draw[ultra thick,>=latex,->,blue!80] (3.7,13.8) to (-0.5,14.2);
	}	
	\visible<4->{
	\node (blabla13) at (5.9,13.1) {{\color{orange} divided into $n$ stages}};
	\node (blabla15) at (5.5,12) {{\color{red} used ADDs smaller}};
	\node (blabla16) at (5.7,11.5) {{\color{red} $\rightarrow$ \textbf{faster computations.}}};
	\draw[ultra thick,>=latex,->,orange] (3.6,13.1) to (0,12.9);	
	\node (accolade) at (-2.35,12.5) {\resizebox{0.93cm}{!}{{ \color{orange} $\{$}}}; 
}
\end{tikzpicture}
\end{figure}
\visible<2->{
\vspace{-0.4cm}
computations on trees: \textit{CU Decision Diagram Package}.
}
\end{frame}

\begin{frame}
\frametitle{Natural factorisation: belief independence.}
\vspace{0.02cm}
\textbf{contribution (AAAI14):} $\pi$-MOMDP following independence assumptions of the graphical model: \\ $\Rightarrow$ { \color{blue} $(s_v,\beta) = (s_{v,1}, \ldots, s_{v,m}, \beta_1, \ldots, \beta_{l})$}, $\beta_i$ belief over $s_{h,i}$. \\
\visible<3->{
\vspace{-0.2cm}
\begin{alertblock}{}
{ \color{red} assumptions:} independent captors, hidden states...
\end{alertblock}
}
\begin{tikzpicture}
\node at (-6.4cm,0cm) {};
\node at (0cm,9.88) {\includegraphics[scale=1]{factMOMDPdid.pdf}};
\visible<2->{
\tikzstyle{bvertex}=[circle,fill=red!60,minimum size=30pt,inner sep=0pt]

	\node[bvertex] (bel1) at (4.5,10.8) {\Large $\beta_1'$};
	\node[bvertex] (bel2) at (3.6,9.8) {\Large $\beta_2'$};
	\node (obs1) at (4.5,8.2) {};
	\node (obs2) at (3.6,8.5) {};
	\node (act) at (0.4,7.9) {};
	\draw[color=red!60,ultra thick,>=latex,->] (obs1) to (bel1); 
	\draw[color=red!60,ultra thick,>=latex,->] (obs2) to (bel2); 
	\draw[color=red!60,ultra thick,>=latex,->] (act) to [bend left] (bel1); 
	\draw[color=red!60,ultra thick,>=latex,->] (act) to [bend left] (bel2); 

	\node[bvertex] (bel11) at (-0.1,10.8) {\Large $\beta_1$};
	\node[bvertex] (bel21) at (-1,9.8) {\Large $\beta_2$};
	\node (obs11) at (-0.1,8.1) {};
	\node (obs21) at (-1,8.4) {};
	\node (act1) at (-4.1,7.9) {};
	\draw[color=red!60,ultra thick,>=latex,->] (obs11) to (bel11); 
	\draw[color=red!60,ultra thick,>=latex,->] (obs21) to (bel21); 
	\draw[color=red!60,ultra thick,>=latex,->] (act1) to [bend left] (bel11); 
	\draw[color=red!60,ultra thick,>=latex,->] (act1) to [bend left] (bel21); 

	\draw[color=red!60,ultra thick,>=latex,->] (bel11) to (bel1); 
	\draw[color=red!60,ultra thick,>=latex,->] (bel21) to (bel2); 


	\node (bel12) at (-5,10.8) {};
	\node (bel22) at (-5,9.8) {};
    	\draw[color=red!60,ultra thick,>=latex,->,dashed] (bel12) to (bel11); 
	\draw[color=red!60,ultra thick,>=latex,->,dashed] (bel22) to (bel21); 
}
\end{tikzpicture}
\end{frame}

\nico{
\begin{frame}
\frametitle{Factorisation naturelle: Indépendance des Croyances.}
\vspace{0.18cm}
\begin{itemize} 
		\item $s_{h,i}$, $s_{h,j}$ \textbf{$d$-separés} par l'évidence $h_t$ (historique) 
	\end{itemize}
\vspace{0.18cm}
	\visible<7->
	{
		 $\rightarrow$ variables cachées $s_{h,i}$ indépendantes sachant $h_t$ \mbox{ i.e. } ${ \color{blue} \beta_t(s_h) } = \pi \paren{ s_h \sachant h_t} = \displaystyle \min_i \pi \paren{s_{h,i} \sachant h_t} = { \color{blue} \displaystyle \min_i \beta_{t,i}(s_{h,i}) } $
		\vspace{-0.4cm}
	}
\vspace{0.1cm}
\begin{figure}[b]\centering
\begin{tikzpicture}
	\visible<2->
	{
	\draw[ultra thick,green!50] (-5,12.7) -- (3,12.7) -- (3,10.7) -- (-3.2,10.7) ;
	\draw[ultra thick,green!50] (-3.2,8.8) -- (4.8,8.8) -- (4.8,7.4) -- (-5, 7.4) ;
	\draw[ultra thick,green!50,dashed] (-3.2,8.8) -- (-5,8.8);
	\draw[ultra thick,green!50,dashed] (-3.2,10.7) -- (-5, 10.7);
	\draw[ultra thick,green!50,dashed] (-6.5,12.7) -- (-5,12.7);
	\draw[ultra thick,green!50,dashed] (-6.5,7.4) -- (-5,7.4);
	\node[green!60] (ev) at (-5.5,12.4) {evidence:};
	\node[green!60] (ev2) at (-5.5,11.9) {\textbf{history} $h_t$};
		
	\draw[ultra thick,red!60] (2.305,10.06) circle (0.375cm);
	\draw[ultra thick,red!60] (2.305,9.26) circle (0.375cm);
	
	}
	\visible<3-3>
	{
		\draw[ultra thick,>=latex,->,red!60] (2,10.2) -- (-2,12);
		\draw[ultra thick,>=latex,->,red!60] (2,10.15) -- (-2,11.25);	
		\node[red!70] at (-1.45,12.4) { \scriptsize blocked};
		\draw[very thick,red!60] (-2.8,12.6) -- (-2,12.6) -- (-2,10.9) -- (-2.8,10.9) -- (-2.8,12.6) ;
	}
	\visible<3->
	{
		\node (check) at (1.4,10.5) {\includegraphics[scale=0.022]{crossCheck.png}};	
		\node (check) at (1,10.45) {\includegraphics[scale=0.022]{crossCheck.png}};	
	}
	
	\visible<4-4>
	{
		\draw[ultra thick,>=latex,->,red!60] (2,10.07) -- (-2,10.07);

			\draw[ultra thick,>=latex,->,red!60] (-2.5,10.07) -- (-5,10.07);
			\draw[ultra thick,>=latex,->,red!60] (-2.45,10.1) -- (-4.85,11.45);
			\draw[ultra thick,>=latex,->,red!60] (-2.42,10.1) -- (-4.32,11.85);
			\node[red!70] at (-5,11) { \scriptsize blocked};	
	}
	\visible<4->
	{
		%\draw[ultra thick,>=latex,->,red!60] (2,11.97) -- (-2,9.5);
		%\draw[ultra thick,>=latex,->,red!60] (2,11.22) -- (-2,9.43);
		\node (check) at (1.25,10.08) {\includegraphics[scale=0.022]{crossCheck.png}};	
	}
	\visible<5-5>
	{
		\draw[ultra thick,>=latex,->,red!60] (2.2,9.95) -- (0.7,8.1);
		\node[red!70] at (0.1,8.5) { \scriptsize blocked};
		\draw[very thick,red!60] (0.17,7.6) -- (0.83,7.6) -- (0.83,8.15) -- (0.19,8.15) -- (0.19,7.6) ;
	}
	\visible<5->
	{
		\node (check) at (1.4,9) {\includegraphics[scale=0.022]{crossCheck.png}};	
	}
	\visible<6-6>
	{
		\draw[ultra thick,>=latex,->,red!60] (2.4,9.98) -- (4,8.38);
		%\draw[ultra thick,>=latex,->,red!60] (2,11.35) -- (-2,11.35);	
		%\draw[ultra thick,>=latex,->,red!60] (2,12.1) -- (-2,11.45);
		\draw[ultra thick,>=latex,->,red!60] (4,8.05) -- (0.7,7.88);
		\node[red!70] at (0.1,8.5) { \scriptsize blocked};
		\draw[very thick,red!60] (0.17,7.6) -- (0.83,7.6) -- (0.83,8.15) -- (0.19,8.15) -- (0.19,7.6) ;
	}
	\visible<6->
	{
		\node (check) at (2.9,9.5) {\includegraphics[scale=0.022]{crossCheck.png}};	
	}
	\node (factMOMDP) at (0,9.88) {\includegraphics[scale=1]{factMOMDPdid.pdf}};
\end{tikzpicture}
\end{figure}
\end{frame}
}


% observations


\begin{frame}
\frametitle{Experiments: Navigation problem -- agent $=$ robot.}
\vspace{-0.2cm}
\centering
\begin{exampleblock}{}
PPUDD vs SPUDD (\textit{Hoey et al.}) \\ 
{ \color{red!70} Navigation benchmark}: reach a goal; spots with accident risk. \\ 
$2$ possibilistic translations: M1 (optimistic) et M2 (cautious). 	
\end{exampleblock}
\visible<2->{
\textbf{ Performances, function of the instance size}  \\
\vspace{0.2cm}
\begin{minipage}{0.45\linewidth}
\centering
{\color{orange} reached goal frequency} \\
\includegraphics[scale=0.4]{courbePerfMDP.pdf} 
\end{minipage}
\begin{minipage}{0.45\linewidth}
\hspace{0.5cm}{\color{orange} time to reach the goal} \\
\includegraphics[scale=0.4]{courbePerfMDP2.pdf} 
\end{minipage} 
}
\end{frame}


\begin{frame}
\frametitle{Experiments: Navigation problem -- agent $=$ robot.}
\begin{minipage}{0.45\linewidth}
\centering
{\color{orange} computation time} \\
\includegraphics[scale=0.4]{courbeTime.pdf} 
\end{minipage}
\hspace{0.13cm}
\begin{minipage}{0.45\linewidth}
{\hspace{0.5cm} \color{orange} max size of ADDs} \\
\includegraphics[scale=0.4]{courbeADD.pdf}  
\end{minipage}
\begin{alertblock}{}
\centering
\begin{itemize}
\item PPUDD + M2 (pessimistic translation)\\ 
\textbf{faster and same performances} as SPUDD;
\item SPUDD only solves the $5$ first instances;
\item verified intuition: ADDs are smaller.
\end{itemize}
\end{alertblock}
\end{frame}

\begin{frame}
\frametitle{Experiments: RockSample problem -- agent $=$ robot.}
\vspace{-0.1cm}
	\begin{exampleblock}{}
	PPUDD vs APPL (\textit{Kurniawati et al.}, solver MOMDP); \\
 	\hspace{1cm} symbolic HSVI (\textit{Sim et al., solver POMDP}). \\
	{ \color{red!70} RockSample benchmark}: recognize and sample ``good'' rocks;
	\end{exampleblock}
	\visible<2->{
\vspace{-0.05cm}
	\begin{minipage}{0.55\linewidth}
	\centering	
	{\color{orange} computation time:}\\ 
	probabilistic solvers, \hspace{-0.2cm} prec. \hspace{-0.3cm} $1$; \\ 
	PPUDD, exact resolution. \\
	\vspace{-0.2cm}
	\includegraphics[scale=0.4]{RockSampleCompTime.pdf}
	\end{minipage}
	\hfill
	\begin{minipage}{0.43\linewidth}
	\centering
	{\color{orange} average of rewards} \\ APPL stopped when \\ PPUDD ends. \\
		\vspace{-0.2cm}
	\includegraphics[scale=0.4]{courbePerfTime.pdf} 
	\end{minipage}

\vspace{-0.1cm}
\begin{alertblock}{}
\begin{itemize}
\item \textbf{approximate model} $+$ \textbf{exact resolution solver} \\
$\rightarrow$ can improve of computation time and performances.
\end{itemize}
\end{alertblock}
}
\end{frame}

\begin{frame}
\frametitle{IPPC 2014 -- MDP track. ADDs-based approaches:\\ 
PPUDD vs symbolic LRTDP (\textit{Bonet et al.})}
\vspace{-0.4cm}
PPUDD $+$ BDD mask over reachable states. \\
\vspace{-0.6cm}
\begin{figure}
\includegraphics[scale=0.3]{IPPC2014_results/academic_advising.pdf}
\includegraphics[scale=0.3]{IPPC2014_results/crossing_traffic.pdf} 
\includegraphics[scale=0.3]{IPPC2014_results/elevator.pdf} \\
\vspace{0.5cm}
\includegraphics[scale=0.3]{IPPC2014_results/skill_teaching.pdf} 
\includegraphics[scale=0.3]{IPPC2014_results/tamarisk.pdf}
\includegraphics[scale=0.3]{IPPC2014_results/triangle_tireworld.pdf} 
\caption{{\color{orange} mean of rewards over simulations.}}
\end{figure}
\end{frame}

\section{Belief factorization}
\begin{frame}

\frametitle{Independent beliefs}
\vspace{-0.85cm}
\hspace{5cm} \textit{A $\pi$-MOMDP fulfilling assumptions of the Dynamic Bayesian Network below has a} \textbf{natural factorization}: \\ { \color{blue} $(s_v,\beta) = (s_{v,1}, \ldots, s_{v,m}, \beta_1, \ldots, \beta_{l})$}, with $\beta_i$ belief about $s_{h,i}$. \\
\visible<2->{
\vspace{-0.2cm}
\begin{alertblock}{}
{ \color{red} some assumptions:} one observation variable for each hidden state variable, hidden state variables independent on other hidden state variables ...
\end{alertblock}
\vspace{-0.2cm}
}
\begin{center}
\hspace{1.35cm}
\includegraphics[scale=1]{factMOMDPdid.pdf}
\end{center}
\end{frame}

\begin{frame}
	\textit{beginning of the proof}:
\begin{itemize} 
		\item $\forall 1 \leqslant i < j \leqslant l$, $s_{h,i}$ and $s_{h,j}$ are \textbf{$d$-separated} by evidence $h_t$ (history) 
	\end{itemize}
	\visible<13->
	{
		 $\rightarrow$ for each time $t$,  hidden state variables $s_{h,i}$ are independent given $h_t$
		\[ \mbox{ i.e. } { \color{blue} \beta_t(s_h) } = \pi \paren{ s_h \sachant h_t} = \displaystyle \min_i \pi \paren{s_{h,i} \sachant h_t} = { \color{blue} \displaystyle \min_i \beta_{t,i}(s_{h,i}) } \]
		\vspace{-0.3cm}
	}
\begin{figure}[b]\centering
\begin{tikzpicture}
	\visible<2->
	{
	\draw[ultra thick,green!50] (-5,12.7) -- (3,12.7) -- (3,10.7) -- (-3.2,10.7) ;
	\draw[ultra thick,green!50] (-3.2,8.8) -- (4.8,8.8) -- (4.8,7.4) -- (-5, 7.4) ;
	\draw[ultra thick,green!50,dashed] (-3.2,8.8) -- (-5,8.8);
	\draw[ultra thick,green!50,dashed] (-3.2,10.7) -- (-5, 10.7);
	\draw[ultra thick,green!50,dashed] (-6.5,12.7) -- (-5,12.7);
	\draw[ultra thick,green!50,dashed] (-6.5,7.4) -- (-5,7.4);
	\node[green!60] (ev) at (-5.5,12.4) {evidence:};
	\node[green!60] (ev2) at (-5.5,11.9) {\textbf{history} $h_t$};
		
	\draw[ultra thick,red!60] (2.305,10.06) circle (0.375cm);
	\draw[ultra thick,red!60] (2.305,9.26) circle (0.375cm);
	
	}
	\visible<3-4>
	{
		\draw[ultra thick,>=latex,->,red!60] (2,10.2) -- (-2,12);
		\draw[ultra thick,>=latex,->,red!60] (2,10.15) -- (-2,11.25);	
		\node[red!70] at (-1.45,12.4) { \scriptsize blocked};
		\draw[very thick,red!60] (-2.8,12.6) -- (-2,12.6) -- (-2,10.9) -- (-2.8,10.9) -- (-2.8,12.6) ;
	}
	\visible<4->
	{
		\node (check) at (1.4,10.5) {\includegraphics[scale=0.022]{crossCheck.png}};	
		\node (check) at (1,10.45) {\includegraphics[scale=0.022]{crossCheck.png}};	
	}
	
	\visible<5-7>
	{
		\draw[ultra thick,>=latex,->,red!60] (2,10.07) -- (-2,10.07);
	}
\nico{
	\visible<6-9>
	{
		\draw[ultra thick,>=latex,->,red!60] (-2.1,10.2) -- (2,12.03);
		%\draw[ultra thick,>=latex,->,red!60] (-2.1,10.15) -- (2,11.27);
	}

	\visible<7-9>
	{
		\draw[ultra thick,>=latex,->,red!60] (2,12.17) -- (-2,12.17);
		%\draw[ultra thick,>=latex,->,red!60] (2,11.35) -- (-2,11.35);	
		\draw[ultra thick,>=latex,->,red!60] (2,12.1) -- (-2,11.45);
		%\draw[ultra thick,>=latex,->,red!60] (2,11.42) -- (-2,12.1);	
		\node[red!70] at (-1.45,12.4) { \scriptsize blocked};
		\draw[very thick,red!60] (-2.8,12.6) -- (-2,12.6) -- (-2,10.9) -- (-2.8,10.9) -- (-2.8,12.6) ;
	}
}
	\visible<6-7>
	{
			\draw[ultra thick,>=latex,->,red!60] (-2.5,10.07) -- (-5,10.07);
			\draw[ultra thick,>=latex,->,red!60] (-2.45,10.1) -- (-4.85,11.45);
			\draw[ultra thick,>=latex,->,red!60] (-2.42,10.1) -- (-4.32,11.85);
			\node[red!70] at (-5,11) { \scriptsize blocked};	
	}
	
	\visible<7->
	{
		%\draw[ultra thick,>=latex,->,red!60] (2,11.97) -- (-2,9.5);
		%\draw[ultra thick,>=latex,->,red!60] (2,11.22) -- (-2,9.43);
		\node (check) at (1.25,10.08) {\includegraphics[scale=0.022]{crossCheck.png}};	
	}
	\visible<8-9>
	{
		\draw[ultra thick,>=latex,->,red!60] (2.2,9.95) -- (0.7,8.1);
		\node[red!70] at (0.1,8.5) { \scriptsize blocked};
		\draw[very thick,red!60] (0.17,7.6) -- (0.83,7.6) -- (0.83,8.15) -- (0.19,8.15) -- (0.19,7.6) ;
	}
	\visible<9->
	{
		\node (check) at (1.4,9) {\includegraphics[scale=0.022]{crossCheck.png}};	
	}
	\visible<10-12>
	{
		\draw[ultra thick,>=latex,->,red!60] (2.4,9.98) -- (4,8.38);
		%\draw[ultra thick,>=latex,->,red!60] (2,11.35) -- (-2,11.35);	
		%\draw[ultra thick,>=latex,->,red!60] (2,12.1) -- (-2,11.45);
	}
	\visible<11-12>
	{
		\draw[ultra thick,>=latex,->,red!60] (4,8.05) -- (0.7,7.88);
		\node[red!70] at (0.1,8.5) { \scriptsize blocked};
		\draw[very thick,red!60] (0.17,7.6) -- (0.83,7.6) -- (0.83,8.15) -- (0.19,8.15) -- (0.19,7.6) ;
	}
	\visible<12->
	{
		\node (check) at (2.9,9.5) {\includegraphics[scale=0.022]{crossCheck.png}};	
	}
	\node (factMOMDP) at (0,9.88) {\includegraphics[scale=1]{factMOMDPdid.pdf}};
\end{tikzpicture}
\end{figure}
\end{frame}


%\section{Conclusions/Perspectives}
\begin{frame}
\frametitle{\insertsection} 
\framesubtitle{\footnotesize towards a hybrid POMDP}
\begin{block}{Possibility Theory:}
\begin{itemize}
\item \textbf{granulated} belief space representation (discretization),\\ 
%\hspace{2.03cm} 
\item efficient problem \textbf{simplification} (PPUDD $2 \times$ better \\
\hspace{5cm} than LRTDP with ADDs);
\item \textbf{ignorance and imprecision} modeling.
\end{itemize}
\end{block}
\visible<2->{
\begin{alertblock}{}
\begin{itemize} 
\item ADD methods $\prec$ state space search methods: \\
winners of IPPC 2014, (PROST $\&$ GOURMAND, \\ 
\hspace{4cm} $2 \times$ better than PPUDD).\\
\item choice of the qualitative criterion (optimistic/pessimistic);
\item non additive utility degrees, from the same scale as possibility degrees.
\end{itemize}
\end{alertblock}
}
\end{frame}


\section{Human-machine interaction}
\begin{frame}
\frametitle{Processus $\pi$-MOMDPs, outils de diagnostic pour l'Intéraction Homme-Machine (avec Sergio Pizziol)}
\vspace{-0.6cm}
\begin{alertblock}{}
\begin{itemize}
\item \textbf{occurrences:} états de la machine et actions humaines;
\item \textbf{évaluation humaine} (de l'état de la machine);
\item \textbf{effets:} transitions, classées par degrés de possibilité.
\end{itemize}
\end{alertblock}
\begin{tikzpicture}[scale=0.8,transform shape]

%TIME
%\node [font=\huge] (statet) at (3.8,1) {$t$};
%\node [font=\huge] (statetplus1) at (8.9,1) {$t+1$};
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%states
\tikzstyle{vertex}=[circle,fill=black!20,minimum size=20pt,inner sep=0pt]
\node (Oc) at (0.8,3.4) {occurrences};
\node (V) at (1.1,3) {(observables) \huge $\{$};
%\node (V) at (1.5,1) {effects \huge $\{$};
\node (H) at (1.2,0) {évaluations \huge $\{$};
\node (H1) at (1,-0.5) {humaines};

\node (E) at (1.7,1.5) {effets \huge $\{$};

%1
\node[vertex] (state1) at (3,3) {$v_0$};
%\node[vertex] (state11) at (2.5,1) {$e_0$};
\node[vertex] (state111) at (3,0) {$h_0$};
%2
\node[vertex] (state2) at (4.5,3) {$v_1$};
%\node[vertex] (state22) at (4,1) {$e_1$};
\node[vertex] (state222) at (4.5,0) {$h_1$};

\node[vertex] (state3) at (6.5,3) {$v_t$};
%\node[vertex] (state33) at (6,1) {$e_t$};
\node[vertex] (state333) at (6.5,0) {$h_t$};

\node (T) at (8.1,0.3) {$T_{t+1} \paren{h_t,h_{t+1}}$};
\node (H) at (7.8,1.7) [rotate=46] {$O \paren{h_t,v_{t+1}}$};

\node[vertex] (state4) at (9.5,3) {$v_{t+1}$};
%\node[vertex] (state44) at (8,1) {$e_{t+1}$};
\node[vertex] (state444) at (9.5,0) {$h_{t+1}$};


\node (state23) at (10.5,3) {$\hdots$};

%3
\node (state5) at (10.8,2) {};
\node (state55) at (10.8,1) {};
\node (state555) at (10.8,0) {};

\node (e0) at (2.9,1.6) [color=black!70] {\huge $e_0$};
\node (e1) at (4.2,1.6) [color=black!70] {\huge $e_1$};
\node (et) at (8.9,1.6) [color=black!70] {\huge $e_{t+1}$};

%SV
% arrows sv->sv
%1->2
\draw[->,>=latex] (state1) -- (state111);
\draw[->,>=latex] (state111) -- (state2);
\draw[->,>=latex] (state111) -- (state222);
%\draw[->,>=latex] (state111) -- (state11);
%\draw[->,>=latex] (state1) -- (state11);


\draw[->,>=latex] (state2) -- (state222);
\draw[->,>=latex,dashed] (state222) -- (state3);
\draw[->,>=latex,dashed] (state222) -- (state333);
%\draw[->,>=latex] (state2) -- (state22);
%\draw[->,>=latex] (state222) -- (state22);
%\draw[->,>=latex] (state111) -- (state22);

\draw[->,>=latex] (state3) -- (state333);
\draw[->,>=latex] (state333) -- (state444);
\draw[->,>=latex] (state333) -- (state4);

%\draw[->,>=latex] (state333) -- (state33);
%\draw[->,>=latex] (state3) -- (state33);
%\draw[->,>=latex,dashed] (state222) -- (state33);
\draw[->,>=latex] (state333) -- (state444);
\draw[->,>=latex] (state4) -- (state444);
\draw[->,>=latex,dashed] (state444) -- (state555);

%\draw[->,>=latex] (state444) -- (state44);
%\draw[->,>=latex] (state4) -- (state44);
%\draw[->,>=latex] (state333) -- (state44);

\draw [scale=0.7,xscale=1.4,ball color=green,opacity=0.2,xshift=40,yshift=35,thick=5pt]
 (9,2.5)..controls +(0,2) and +(1.3,2) ..(7,2.5) % angle haut
 ..controls +(-1.3,-2) and +(1.3,2) ..(5.2,-0.2) % ligne gauche inclinee
 ..controls +(-1.3,-2) and +(-1,0).. (6,-2) % angle inferieur gauche
 ..controls +(-1,0) and +(1,0).. (8,-2)
 ..controls +(1,0) and +(0,-2).. (9,0.5) % angle inferieur droit
 ..controls +(0,1) and +(0,-1).. (9,2.5); % arc 4

\draw [scale=0.7,xscale=0.8,ball color=green,opacity=0.2,xshift=-5,yshift=35,thick=5pt]
 (9,2.5)..controls +(0,2) and +(1.3,2) ..(7,2.5) % angle haut
 ..controls +(-1.3,-2) and +(1.3,2) ..(5.2,-0.2) % ligne gauche inclinee
 ..controls +(-1.3,-2) and +(-1,0).. (6,-2) % angle inferieur gauche
 ..controls +(-1,0) and +(1,0).. (8,-2)
 ..controls +(1,0) and +(0,-2).. (9,0.5) % angle inferieur droit
 ..controls +(0,1) and +(0,-1).. (9,2.5); % arc 4


\draw [scale=0.7,xscale=0.8,yscale=0.95,ball color=green,opacity=0.2,xshift=-67,yshift=58,thick=5pt]
 (8.5,2.5)..controls +(0,1) and +(0,1) ..(7,2.5) % angle haut
 ..controls +(0,1) and +(0,-1) ..(7,-2) 
 ..controls +(0,-1) and +(0,-1).. (8.5,-2) % angle inferieur droit
 ..controls +(0,1) and +(0,-1).. (8.5,2.5); % arc 4

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% TRANSITION FUNCTIONS
%\node (T1) at (7.1,2.05) {$T^{a,1}$};
%\node (T2) at (7,1.45) {$T^{a,2}$};
\end{tikzpicture}
\visible<2->{
\begin{itemize}
\item \textbf{estimation} de l'état selon l'opérateur humain;
\item \textbf{détection} des erreurs humaines d'évaluation de l'état; 
\item causes plausibles de ces erreurs (\textbf{diagnostique}).
\end{itemize}
}
\end{frame}



\section{An hybrid POMDP} %TODO comparison with ODAS until here
\begin{frame}
\definecolor{bblue}{rgb}{0,0.4,0.75}
\frametitle{A possibilistic belief state}
\framesubtitle{\footnotesize belief space discretization }
\vspace{0.2cm}
$\Pi_{S} = \Big\{$ possibility distributions $\Big\}$: $\# \Pi_{S} < + \infty$\\ 
\vspace{0.1cm} 
$\rightarrow $ \textbf{belief space discretization}.
\vspace{-0.1cm}
\visible<2->{
\[ { \color{bblue}  b^{\pi}_{t} (s) = \pi \paren{ s_t = s \sachant a_0,o_1, \ldots, a_{t-1}, o_t } } \]
}
\vspace{-0.6cm}
\visible<3->{
\begin{exampleblock}{update -- \textbf{possibilistic} belief state}
\vspace{0.1cm}
$b^{\pi}_{t+1}(s')  %= u(b^{\pi}_{t},a,o')(s') 
=  \left \{ \begin{array}{ccc} 1 & \hspace{-1cm} \mbox{ if } \pi \paren{ o',s' \sachant b_t^{\pi}, a} = \pi \paren{ o' \sachant b_t^{\pi}, a} \\
\pi \paren{ o', s' \sachant b_t^{\pi}, a} & \mbox{ otherwise.}  
\end{array} \right.$ \\
\vspace{0.3cm}
${ \color{red} \mbox{ denoted by } }  { b^{\pi}_{t+1}(s') \color{red} \propto^{\pi} \pi \paren{o',s'\sachant b_t^{\pi}, a}} $
\end{exampleblock}
}
\visible<4>{
\begin{itemize}
\item $\displaystyle  \pi ( o', s' \vert b_t^{\pi}, a)  = \max_{s \in \mathcal{S}} \min \Big\{ \pi ( o' \vert s', a ), \pi ( s' \vert s, a ), b^{\pi}_t(s) \Big\}$;
\item $ \displaystyle \pi \paren{o' \sachant s', a} = \max_{s' \in \mathcal{S} } \pi \paren{ o',s' \sachant b^{\pi}_t, a  }$.
\end{itemize}
}
\vspace{-0.2cm}
\visible<5->{
\begin{block}{}
\begin{itemize}
\item the update \textbf{only depends on $o'$ and $a$}.
\end{itemize}
\end{block}
}
\end{frame}

\begin{frame}
\frametitle{Pignistic transformation and transitions}
\framesubtitle{\footnotesize Pignistic transformation}
numbering of the $n = \# \mathcal{S}$ system states:
$1 = b^{\pi}(s_1) \geqslant \ldots \geqslant b^{\pi}(s_{n}) \geqslant b^{\pi}(s_{n+1}) = 0$.
\begin{exampleblock}{\textbf{pignistic transformation} -- $P: \Pi_{\mathcal{S}} \rightarrow \mathbb{P}_{S} $}
\[ \overline{b^{\pi}}(s_i) = \sum_{j=i}^{\# \mathcal{S}} \frac{b^{\pi}(s_j) - b^{\pi}(s_{j+1})}{j}.\]
\end{exampleblock}
\begin{itemize}
\item probability distribution $\overline{b^{\pi}}$ $=$ \textbf{gravity center} \\ 
\hspace{1cm} of the represented probabilistic distributions;
%induites par la distribution de possibilité $b^{\pi}$ 
\item \textbf{Laplace principle}: ignorance $\rightarrow$ uniform probability.
\end{itemize}
%\begin{tikzpicture} 
%\draw [domain=-7:-1] plot(\x,0);
%\draw [domain=-2:2, scale=0.6] plot (\x-7.5,{exp(-\x*\x)});
%\draw [domain=-2:3, scale=0.6] plot (\x-7.5,{0.5*exp(-\x*(\x-2))});
%\node (poss) at (-3,0.5) {$\pi$};
%\node (pref) at (-5.5,0.5) {$\mu$};
%\node (S) at (-7.5,0) {$S$};
%\draw [domain=-2:2] plot(\x,0);
%\draw [domain=-1:0.35, scale=0.6, color=red] plot (\x-1,{0.5*exp(-\x*(\x-2))});
%\draw [domain=0.35:2, scale=0.6, color=red] plot (\x-1,{exp(-\x*\x)});
%\draw [domain=-2:0.35, scale=0.6, color=blue] plot (\x-1,{exp(-\x*\x)});
%\draw [domain=0.35:3, scale=0.6, color=blue] plot (\x-1,{0.5*exp(-\x*(\x-2))});
%\node [color=red] (inter) at (-0.5,-0.2) {$f_{\textbf{P} \cap \textbf{M}}$};
%\node [color=blue] (union) at (-1.5,0.7) {$f_{\textbf{P} \cup \textbf{M}}$};
%\end{tikzpicture}
\end{frame}

\begin{frame}
\frametitle{Pignistic transformation}
\framesubtitle{\footnotesize Examples of pignistic transformations (red) of possibility distributions (blue)}
\end{frame}

\begin{frame}
\frametitle{Pignistic transformation and transitions}
\framesubtitle{\footnotesize Transition function of epistemic states}
Approximation of the probabilities over the observations:
\begin{itemize}
\item $\textbf{p} \paren{ o' \sachant s,a } = \sum_{s' \in \mathcal{S}} O(s',a,o') \cdot T(s,a,s');$
\item { \color{red} $ \displaystyle \textbf{p}\paren{o'\sachant b^{\pi},a} := \sum_{s\in\mathcal{S}}\textbf{p}\paren{o' \sachant s,a}\cdot\overline{b^{\pi}}(s)$.}
\end{itemize}
\begin{block}{}
\[ \Rightarrow \textbf{p} \Big( (b^{\pi})' \Big\vert b^{\pi},a \Big) = \sum_{ \substack{ o' \mbox{ \footnotesize t.q. } \\ u(b^{\pi},a,o')=(b^{\pi})'} }\textbf{p}\paren{o'\sachant b^{\pi},a}.\]
\end{block}
\vspace{0.5cm}
notation: if $a \in \mathcal{A}$ selected, $o' \in \mathcal{O}$ received,\\ 
\[ b^{\pi}_{t+1} = u \paren{o',a,b^{\pi}_t} = \mbox{ update of } b^{\pi}_t. \]
\end{frame}



\begin{frame}
\frametitle{Choquet integral and rewards}
\framesubtitle{\footnotesize pessimistic evaluation of the rewards -- 
necessity measure}
imprecision of $b^{\pi}$ $=$ agent ignorance $+$ discretization: 
\textbf{pessimistic reward} about these imprecisions.
\visible<2->{
\vspace{-0.15cm}
\begin{alertblock}{Dual measure of $\Pi:2^{\mathcal{S}} \rightarrow \mathcal{L}$}
necessity $\mathcal{N}$ such that
$\forall A \subseteq \mathcal{S}$, $\mathcal{N}(A) = 1 - \Pi(\overline{A})$.
\end{alertblock}
}
\visible<3->{
\vspace{-0.1cm}
%$a \in \mathcal{A}$ fixé:
$r_1 \hspace{-0.1cm} > \hspace{-0.1cm} r_2 > \hspace{-0.1cm} \ldots \hspace{-0.1cm} > \hspace{-0.1cm} r_{k+1} \hspace{-0.05cm}= \hspace{-0.05cm}0$ represents elements of
$\big\{ \hspace{-0.02cm} r(s,a) \hspace{-0.02cm} \big\vert \hspace{-0.02cm} s \in \mathcal{S} \hspace{-0.02cm} \big\}$. %$k \leqslant \# \mathcal{S}$.\\
\vspace{-0.15cm}
\begin{block}{Choquet integral of $r$ with respect to $\mathcal{N}$}
\vspace{-0.6cm}
\begin{eqnarray}
Ch(r,\mathcal{N}) & = & \displaystyle \sum_{i=1}^{k} (r_i - r_{i+1}) \cdot \mathcal{N} \paren{ \set{r(s) \geqslant r_i} }\\
\vspace{-0.1cm}
\visible<4->{
\label{choquet2} & = & \displaystyle \sum_{i=1}^{\# \mathcal{L}-1} (l_i - l_{i+1}) \cdot \hspace{-0.1cm} \min_{ \substack{ s \in \mathcal{S} \mbox{ \scriptsize  s.t. } \\ b^{\pi}(s) \geqslant l_i } }  r(s).
} 
\end{eqnarray}
\end{block}
\vspace{-0.1cm}
\visible<4->{
notation $\mathcal{L} = \set{ l_1=1,l_2,l_3, \ldots, 0 }$.
}
}
\end{frame}
\begin{frame}
\frametitle{Choquet integral and rewards}
\framesubtitle{\footnotesize back to the example about ignorance}
%\begin{itemize}
%\item croyance initiale deterministe $s_0=s_A$;\\
%\item $ \set{ s_B, s_C, s_D }$ $\xrightarrow{\mbox{\scriptsize déterministe}}s_E$, $r(s_E)=0$.
%\end{itemize}
\begin{tikzpicture}
\node (L) at (-1,0) {};
\node (R) at (8.5,0) {};
\draw[thick,dashed,color=black!30] (L) to (R);
\tikzstyle{avertex}=[circle,fill=green!30,minimum size=20pt,inner sep=0pt]
\node[avertex] (a1) at (1,1.5) {$a'$};
\node[avertex] (a2) at (1,-1.5) {$\tilde{a}$}; 

\tikzstyle{vertex}=[circle,fill=black!30,minimum size=20pt,inner sep=0pt]
\node[vertex] (sA) at (0,0) {$s_A$};
\node (b0) at (-0.7,-0.7) {$b^{\pi}_0(s_A) = 1$};
\node[vertex] (sB) at (3,2) {$s_B$};
\node (b1A) at (5,2) {$b^{\pi}_1(s_B) = 1$};
\node[vertex] (sC) at (3,1) {$s_C$};
\node (b1B) at (5,1.2) {$b^{\pi}_1(s_C) = 1$};
\node (b1B) at (5,0.4) {$b^{\pi}_1(s_D) = 0$};
\node[vertex] (sD) at (3,-1) {$s_D$};
\node (b1C) at (5,-1) {$b^{\pi}_1(s_D) = 1$};
\node (b1C) at (5,-1.8) {$b^{\pi}_1(s_B) = b^{\pi}_1(s_C) = 0$};

\node[fill=yellow] (rA) at (8,2) {$r(s_B)=10$};
\node[fill=yellow] (rB) at (8,1) {$r(s_C)=0$};
\node[fill=yellow] (rC) at (8,-1) {$r(s_D)=5$};

\draw[->,>=latex,thick,color=red] (sA) to (sB);
\draw[->,>=latex,thick,color=red] (sA) to (sC);
\draw[->,>=latex,thick,color=blue] (sA) to (sD);
\end{tikzpicture}
\vspace{-0.8cm}
\visible<2->{
\begin{block}{}
% $\mathbb{E}_{s_0 \sim b_0} \croch{ r(s_1) \sachant a_0 = \tilde{a} } = \mathbb{E}_{b_0} \croch{ r(s_1) \sachant a' } = r(s_0) + \frac{\gamma}{2}$. \\
\begin{itemize}
\item $Ch \paren{ r, N_{b^{\pi}_1} \sachant a_0 = \tilde{a} } = r(s_D,\tilde{a}) = 5$, 
\item $Ch \paren{ r, N_{b^{\pi}_1} \sachant a_0 = a' } = \min_{s \in \mathcal{S}} r(s,a') = 0$. \\ 
\end{itemize}
the safe action is prefered! \textbf{dispersion reduced}
\end{block}
}
\visible<3->{	
if $\mathcal{N}_{b^{\pi}_1}$ replaced by $b_1$
$\Rightarrow$ $Ch(r,b_1) = \mathbb{E}_{s \sim b_1} \croch{r(s,a)}$.
% \sum_{s \in \mathcal{S}} r(s,a) \cdot b_1(s)$.
}
\end{frame}

\begin{frame}
\frametitle{resulting MDP}

\framesubtitle{\footnotesize translation summary}
\vspace{0.3cm}
input: a POMDP $\langle \mathcal{S},\mathcal{A},\mathcal{O},T,O,r, \gamma \rangle$; \\
output: the MDP $\langle \tilde{\mathcal{S}},\mathcal{A},\tilde{T},\tilde{r}, \gamma \rangle$:
\vspace{0.3cm}
\visible<2->{
\begin{itemize}
\item \textbf{state space} ${ \color{red} \tilde{\mathcal{S}} = \Pi_{\mathcal{S}} }$,\\ 
the set of the possibility distributions over $\mathcal{S}$;
\end{itemize}
}
\vspace{0.3cm}
\visible<3->{
\begin{itemize}
\item $\forall b^{\pi}, (b^{\pi})'$ possibilistic belief states $\in \Pi_{\mathcal{S}}$, $\forall a \in \mathcal{A}$,\\
\textbf{transitions} ${ \color{red} \tilde{T} \Big( b^{\pi}, a, (b^{\pi})' \Big) = \textbf{p} \Big( (b^{\pi})' \Big\vert b^{\pi},a \Big) }$;
\end{itemize}
}
\vspace{0.3cm}
\visible<4->{
\begin{itemize}
\item \textbf{reward} ${ \color{red}  \tilde{r}(a,b^{\pi}) = Ch \Big( r(a,.),\mathcal{N}_{b^{\pi}} \Big) }$,\\ 
$\mathcal{N}_{b^{\pi}}$ necessity measure computed from $b^{\pi}$.
\end{itemize}
}
\vspace{0.2cm}
\visible<5->{
\[ \mbox{ \textbf{criterion:} } \mathbb{E}_{ (b^{\pi}_t) \sim \tilde{T}} \croch{ \sum_{t=0}^{+ \infty} \gamma^t \cdot \tilde{r} \paren{ b^{\pi}_t,d_t } }.\]
}
\end{frame}

\begin{frame}
\frametitle{hybrid POMDP and $\pi$-POMDP}
\framesubtitle{\footnotesize differences with possibilistic models}
\begin{tabular}{|c||c|c|}
  \hline
  & hybrid POMDP  & $\pi$-POMDP \\
  \hline \hline
\hspace{-0.2cm} transitions \hspace{-0.2cm} & probabilities & qualitative possibility \\
  \hline
\hspace{-0.2cm} rewards \hspace{-0.2cm} & quantitative $\in \mathbb{R}$ & qualitative $\in \mathcal{L}$  \\
  \hline
\hspace{-0.2cm} situation \hspace{-0.2cm} & 
\begin{tabular}{c} -some imprecisions \\ -large POMDP \end{tabular} & few quantitative \\
  \hline
\hspace{-0.2cm} issues & $\pi$ definition & commensurability \\
  \hline
in practice & MDP & $\pi$-MDP\\
\hline
\end{tabular}
\\
\vspace{0.3cm}
\visible<2->{
\textbf{hybrid model:}
\begin{itemize}
\item only belief states are possibilistic:
\end{itemize}
$\rightarrow$ agent knowledge $=$ \textbf{possibility} distribution;
\begin{itemize}
\item probabilistic dynamics:
\end{itemize}
$\rightarrow$ \textbf{approximated} (prob.) transition between epistemic states. 
}
\end{frame}

\section{Benefiting from factorized structures}
\begin{frame}
\frametitle{factorized POMDP}
\framesubtitle{\footnotesize definition}
\begin{itemize}
\item $\mathcal{S}$ described by $\mathbb{S} = \set{ s_1, \ldots, s_m }$: $\mathcal{S} = s_1 \times \ldots \times s_m$.\\
Notation: $\mathbb{S}' = \set{s_1', \ldots, s_m'}$;
\end{itemize}
\visible<2->{
\begin{itemize}
\item \textbf{transition} function of $s_j'$,\\ 
$T_j^a(\mathbb{S}, s'_j) = \textbf{p} \paren{ s'_j \sachant \mathbb{S}, a}$,
$\forall j \in \set{1, \ldots, m}$ et $\forall a \in \mathcal{A}$;
\end{itemize}
}
\visible<3->{
\begin{itemize}
\item $\mathcal{O}$ described by $\mathbb{O}=\set{ o_1, \ldots, o_n }$: $\mathcal{O} = o_1 \times \ldots \times o_n$;
\end{itemize}
}
\visible<4->{
\begin{itemize}
\item \textbf{observation} function of $o_i'$,\\
$O_i^a(\mathbb{S}', o'_i) = \textbf{p} \paren{ o'_i \sachant \mathbb{S}', a}$,
$\forall i \in \set{1,\ldots,n}$ et $\forall a \in \mathcal{A}$.
\end{itemize}
}
\vspace{0.3cm}
\visible<5->{
\textbf{independences:} \\
\vspace{0.1cm}
$\rightarrow$ $ \forall s_i',s_j' \in \mathbb{S}'$, \hspace{0.55cm} $s_i' \perp\!\!\!\perp s_j' \ \vert \set{\mathbb{S}, a \in \mathcal{A} }$,\\
\vspace{0.3cm}
$\rightarrow$ $\forall o_i', o_j' \in \mathbb{O}'$, \hspace{0.3cm} $o_i' \perp\!\!\!\perp o_j' \ \vert \set{ \mathbb{S}', a \in \mathcal{A} }$.
}
\end{frame}

\begin{frame}
\frametitle{Notations}
\framesubtitle{\footnotesize some variables does not interact with each other}
\begin{tikzpicture}
\node (legend0) at (-1,0.5) {};
\node (legend) at (-1,0.2) {variables about the \textbf{current} system state,};
\node (legend2) at (3,-1.5) {variable $s_j'$ about};
\node (legend3) at (3,-2.1) { the \textbf{next} state.};
\begin{scope}[scale=1.2,transform shape]
\visible<2->{
\node (A) at (-4.2,-1.1) { {\color[rgb]{0.3,0.7,0.4} $s_k \rightarrow s_j'$}};
}
\end{scope}

\definecolor{ggreen}{rgb}{0.3,0.7,0.4};
%	\node (legend2) at (-4,-0.6) {$s_k \thickrightarrow s_j'$};
\visible<2->{
\node (legend2) at (-5,-1.9) {{\color{ggreen} $\Updownarrow$}};
\node (legend2) at (-5,-2.5) {{\color{ggreen} $\exists a \in \mathcal{A}$, such that}};
\node (legend2) at (-5,-3.25) {{\color{ggreen} $T^a_j(\mathbb{S},s_j')$ depends on $s_k$.}};
}
%node
\tikzstyle{vertex}=[circle,fill=black!30,minimum size=20pt,inner sep=0pt]
\node[vertex] (s1) at (0,-0.5) {$s_1$};
\node (dots1) at (0,-1) {$\vdots$};
\node[vertex] (sk1) at (0,-1.7) {$s_{j_1}$};
\node (dots2) at (0,-2.2) {$\vdots$};
\node[vertex] (sk2) at (0,-2.9) {$s_{j_2}$};
\node (skF1) at (0,-3.7) {};
\node (skF2) at (0,-4.3) {};
\node (skF3) at (0,-4.9) {};
\node (dots3) at (0,-3.55) {$\vdots$};
\node (dots3) at (0,-4) {$\vdots$};
\node (dots3) at (0,-4.45) {$\vdots$};
\node[vertex] (sk3) at (0,-5.3) {$s_{j_k}$};
\node (dots4) at (0,-5.8) {$\vdots$};
\node[vertex] (sm) at (0,-6.5) {$s_m$};
\node[vertex] (spj) at (3.5,-3.5) {$s_j'$};
\visible<2->{
%draw
\draw[->,>=latex,thick,color=ggreen] (sk1) to (spj);
\draw[->,>=latex,thick,color=ggreen] (sk2) to (spj);
\draw[->,>=latex,thick,dashed,color=ggreen] (skF1) to (spj);
\draw[->,>=latex,thick,dashed,color=ggreen] (skF2) to (spj);
\draw[->,>=latex,thick,dashed,color=ggreen] (skF3) to (spj);
\draw[->,>=latex,thick,color=ggreen] (sk3) to (spj);
}
\visible<3->{
%legend
%\tikzstyle{point}=[circle,fill=black]
\node (nearP) at (-3,-4.5) {};
\draw[ultra thick,color=black!30] (sk1) to (nearP);
\draw[ultra thick,color=black!30] (sk2) to (nearP);
\draw[ultra thick,dashed,color=black!30] (skF1) to (nearP);
\draw[ultra thick,dashed,color=black!30] (skF2) to (nearP);
\draw[ultra thick,dashed,color=black!30] (skF3) to (nearP);
\draw[ultra thick,color=black!30] (sk3) to (nearP);
 
\node (parents) at (-3.5,-4.5) {$\mathcal{P}(s_j')$};
\node (parents2) at (-5,-5.4) {the parents of $s_j'$ are:};
\node (parents2) at (-4.5,-6) {$\mathcal{P}(s_j') = \set{ s \in \mathbb{S} \sachant s \rightarrow s_j'} $};
\node (parents3) at (-4.3,-6.6) {$ = \set{ s_{j_1}, s_{j_2}, \ldots,s_{j_k} }.$};
}
%\begin{scope}[scale=6,transform shape]
%\node (A) at (-0.1,-0.42) {$\{$};
%\end{scope}
\end{tikzpicture}
\end{frame}

\begin{frame}
\vspace{0.25cm}
\begin{tikzpicture}
\definecolor{ggreen}{rgb}{0.3,0.7,0.4};
\frametitle{Notations}
\framesubtitle{\footnotesize concerning observation variables}
\visible<2->{
\begin{scope}[scale=1.2,transform shape]
\node (A) at (-2.1,-0.2) { {\color{red} $s_j' \rightarrow o_i'$}};
\end{scope}
\node (legend2) at (-2.5,-0.9) {{\color{red} $\Updownarrow$}};
\node (legend2) at (-2.5,-1.5) {{\color{red} $\exists a \in \mathcal{A}$, such that}};
\node (legend2) at (-2.5,-2.25) {{\color{red} $O^a_i(\mathbb{S}',o_i')$}};
\node (legend2) at (-2.5,-2.85) {{\color{red} depends on $s_j'$.}};
}
\tikzstyle{vertex}=[circle,fill=black!30,minimum size=20pt,inner sep=0pt]
\visible<4->{
\node (led) at (1.7,0) {\textbf{current} state};
\node[vertex] (s1) at (0,0) {$s_1$};
\node (dots1) at (0,-0.5) {$\vdots$};
\node[vertex] (sk1) at (0,-1.2) {$s_{k_1}$};
\node (dots2) at (0,-1.7) {$\vdots$};
\node[vertex] (sk2) at (0,-2.4) {$s_{k_2}$};
\node (dots3) at (0,-2.9) {$\vdots$};
\node[vertex] (sk3) at (0,-3.6) {$s_{k_3}$};
\node (dots4) at (0,-4.1) {$\vdots$};
\node (dots5) at (0,-4.55) {$\vdots$};
\node (dots6) at (0,-4.95) {$\vdots$};
\node[vertex] (sk4) at (0,-5.65) {$s_{k_n}$};
\node (dots7) at (0,-6.15) {$\vdots$};
\node[vertex] (sm) at (0,-6.85) {$s_m$};
}
\node (led) at (5,0) {\textbf{next} state};
\node[vertex] (sp1) at (5,-0.9) {$s_1'$};
\node (dotsp1) at (5,-1.42) {$\vdots$};
\node[vertex] (spj1) at (5,-2.14) {$s'_{j_1}$};
\node (dotsp2) at (5,-2.64) {$\vdots$};
\node[vertex] (spj2) at (5,-3.34) {$s'_{j_2}$};
\node (dotsp3) at (5,-3.86) {$\vdots$};
\node (dotsp5) at (5,-4.14) {$\vdots$};
\node (dotsp6) at (5,-4.55) {$\vdots$};
\node[vertex] (spj3) at (5,-5.28) {$s'_{j_m}$};
\node (dotsp4) at (5,-5.78) {$\vdots$};
\node[vertex] (smp) at (5,-6.5) {$s'_m$};

\visible<3>{
\node (poi) at (2.3,-6.3) {$\mathcal{P}(o_i') \hspace{-0.07cm} = \hspace{-0.07cm} \set{ \hspace{-0.07cm} s' \hspace{-0.07cm} \in \hspace{-0.07cm} \mathbb{S}' \hspace{-0.05cm} \sachant \hspace{-0.15cm} s' \hspace{-0.07cm} \rightarrow \hspace{-0.07cm} o_i' \hspace{-0.07cm}} $};
\node (h2) at (2.8,-6.9) { $= \set{ s'_{j_1}, s'_{j_2}, \ldots, s'_{j_m} }$};

\visible<3>{
\node (nearP) at (1.2,-6.2) {};
\draw[ultra thick,color=black!30] (spj1) to (nearP);
\draw[ultra thick,color=black!30] (spj2) to (nearP);
\draw[ultra thick,color=black!30] (spj3) to (nearP);
\draw[ultra thick,dashed,color=black!30] (dotsp6) to (nearP);
\draw[ultra thick,dashed,color=black!30] (dotsp5) to (nearP);
}
}

\visible<5->{
\draw[->,>=latex,thick,color=ggreen] (sk1) to (spj1);
\draw[->,>=latex,thick,color=ggreen] (sk2) to (spj1);
\draw[->,>=latex,thick,color=ggreen] (sk3) to (spj1);
\draw[->,>=latex,thick,color=ggreen] (sk2) to (spj2);
\draw[->,>=latex,thick,color=ggreen] (sk4) to (spj2);
\draw[->,>=latex,thick,color=ggreen] (sk1) to (spj3);
\draw[->,>=latex,thick,dashed,color=ggreen] (dots4) to (dotsp5);
\draw[->,>=latex,thick,dashed,color=ggreen] (sk2) to (dotsp5);
\draw[->,>=latex,thick,dashed,color=ggreen] (dots5) to (dotsp6);
\draw[->,>=latex,thick,dashed,color=ggreen] (dots5) to (spj2);
}
\visible<-2>{
\node (o) at (6.4,-1.3) {\textbf{observation}};
\node (o) at (6.35,-1.7) {variable n\textsuperscript{o} $i$};
}
\node[vertex] (opi) at (7,-2.6) {$o'_{i}$};
\visible<2->{
\draw[->,>=latex,thick,color=red] (spj1) to (opi);
\draw[->,>=latex,thick,color=red] (spj2) to (opi);
\draw[->,>=latex,thick,color=red] (spj3) to (opi);
\draw[->,>=latex,thick,dashed,color=red] (dotsp5) to (opi);
\draw[->,>=latex,thick,dashed,color=red] (dotsp6) to (opi);
}
\visible<6>{
\node (nearPS) at (3.1,-1) {$\mathcal{P}(s_{j_2}')$};
\draw[ultra thick,color=black!30] (sk2) to (nearPS);
\draw[ultra thick,color=black!30] (sk4) to (nearPS);
\draw[ultra thick,dashed,color=black!30] (dots5) to (nearPS);
}

\visible<7->{
\node (parents) at (-3.5,-5.7) {$\mathcal{Q}(o_i')$}; 
\node (parents) at (-1.6,-6.2) {$ =\hspace{-0.3cm} \displaystyle \bigcup_{s_j' \in \mathcal{P}(o_i')} P(s_j')$}; 
\node (parents) at (-2.2,-7) {$ = \set{ s_{k_1},s_{k_2},\ldots,s_{k_n} }$};

\node (nearQ) at (-3,-5.5) {};
\draw[ultra thick,color=black!30] (sk1) to (nearQ);
\draw[ultra thick,color=black!30] (sk2) to (nearQ);
\draw[ultra thick,color=black!30] (sk3) to (nearQ);
\draw[ultra thick,dashed,color=black!30] (dots4) to (nearQ);
\draw[ultra thick,dashed,color=black!30] (dots5) to (nearQ);
\draw[ultra thick,color=black!30] (sk4) to (nearQ);
}
\end{tikzpicture}
\end{frame}

\begin{frame}
\frametitle{Rewritings of parameters}
\framesubtitle{\footnotesize \textbf{PROBABILISTIC} parameters}
\begin{itemize}
\item $T^a_j \paren{ \mathbb{S},s_j' } = T^a_j \paren{\mathcal{P}(s_j'),s_j'}$;
\item $O^a_i \paren{ \mathbb{S}',o_i' } = O^a_i \paren{\mathcal{P}(o_i'),o_i'}$.
\end{itemize}
\visible<2->{
\begin{block}{consequences on the joint distribution}
\vspace{-0.3cm}
\begin{align*}
\textbf{p} \paren{ o_i', \mathcal{P}(o_i') \sachant \mathbb{S}, a} & = O^a_i \paren{ \mathcal{P}(o_i'), o_i'} \cdot \displaystyle \prod_{s_j'\in\mathcal{P}(o_i')} T^a_i \paren{\mathcal{P}(s_j'),s_j'} \\
& = \textbf{p} \paren{ o_i', \mathcal{P}(o_i') \sachant \mathcal{Q}(o_i'), a}.
\end{align*}
\end{block}
}
\visible<3->{
\vspace{-0.2cm}
\begin{alertblock}{observation probabilities}
epistemic state % sur $\mathbb{S}$: $b^{\pi} \in \Pi_{S}$.
\vspace{-0.7cm}
\begin{equation*}
 b^{\pi}(\mathbb{S}) \xrightarrow{ \mbox{\footnotesize \textbf{marginalization}} }  b^{\pi}(\mathcal{Q}(o_i')) \xrightarrow{ \begin{array}{cc} \mbox{\footnotesize \textbf{pignistic}}
\vspace{-0.2cm}
\\
 \mbox{\footnotesize \textbf{transformation}} \end{array} } \overline{b^{\pi}}(\mathcal{Q}(o_i')) 
\end{equation*} 
\vspace{-0.5cm}
\[ { \color{red} \textbf{p} \paren{ o_i' \sachant b^{\pi}, a } } = \sum_{2^{\mathcal{P}(o_i')},2^{\mathcal{Q}(o_i')}} \textbf{p} \paren{ o_i', \mathcal{P}(o_i') \sachant \mathcal{Q}(o_i'), a} \cdot \overline{b^{\pi}}(\mathcal{Q}(o_i')) \]
\end{alertblock}
}
\end{frame}
\begin{frame}
\frametitle{Parameters rewritings}
\framesubtitle{\footnotesize \textbf{POSSIBILISTIC} parameters}
\begin{itemize}
\item $\pi \paren{ s_j' \sachant \mathbb{S}, a } = \pi \paren{s_j' \sachant \mathcal{P}(s_j'), a}$;
\item $\pi \paren{ o_i' \sachant \mathbb{S}', a } = \pi \paren{o_i' \sachant \mathcal{P}(o_i'), a}$.
\end{itemize}
\visible<2->{
\begin{alertblock}{marginal possibilistic belief states}
$\forall o_i' \in \mathbb{O}$,\\
$ \displaystyle b^{\pi}_{t+1} \Big( \hspace{-0.05cm} \mathcal{P}(o_i') \hspace{-0.05cm} \Big) \propto^{\pi}  \pi  \Big( o_i', \mathcal{P}(o_i') \Big\vert a_0,o_1, \ldots, a_{t-1}, o_{t} \Big)$ \\
\visible<3->{
\hspace{2.93cm} $\displaystyle = \max_{2^{\mathcal{Q}(o_i')}} \hspace{-0.05cm} \min \hspace{-0.07cm} \Bigg\{ \hspace{-0.07cm} \pi \hspace{-0.05cm} \Big( \hspace{-0.05cm} o_i', \hspace{-0.05cm} \mathcal{P}(o_i') \hspace{-0.02cm} \Big\vert \hspace{-0.02cm} \mathcal{Q}(o_i'), \hspace{-0.05cm} a \hspace{-0.05cm} \Big)\hspace{-0.05cm}, \hspace{-0.05cm} b^{\pi}_t \hspace{-0.05cm} \Big( \hspace{-0.05cm} \mathcal{Q}(o_i') \hspace{-0.05cm} \Big) \hspace{-0.1cm} \Bigg\}$\\
}
\visible<4->{
\hspace{5cm} denoted by { \color{red} $\pi \Big( o_i', \mathcal{P}(o_i') \Big\vert b^{\pi}_t, a \Big)$}.
}
\end{alertblock}
}
\end{frame}


\begin{frame}
\frametitle{Variable classification}
\framesubtitle{\footnotesize $3$ classes of state variables}%: extension des MOMDPs (Araya-L\'opez, Ong)}
\vspace{0.1cm}
\begin{tikzpicture}
\definecolor{violet}{rgb}{0.7,0.1,0.5};
\definecolor{orangee}{rgb}{1,0.7,0.1};
\definecolor{gggreen}{rgb}{0,0.7,0.7};
% separations
\node (T1) at (-1.5,8.4) {};
\node (B1) at (9,8.4) {};
\draw[thick,dashed,color=black!30] (B1) to (T1);
\node (T2) at (-1.5,5.1) {};
\node (B2) at (9,5.1) {};
\draw[thick,color=black!30] (B2) to (T2);

% variables
\tikzstyle{vertex}=[circle,fill=black!30,minimum size=20pt,inner sep=0pt]
\node (V) at (1,10) { \underline{variable:} \color{violet} visible $s_v \in \mathbb{S}_v$ };
\node[vertex] (vv) at (6.5,9.7) {$s_v'$};
\node (IHV) at (1.3,8) { {\color{gggreen} inferred hidden $ s_h \in \mathbb{S}_h$} };
\node[vertex] (ihv) at (6.5, 7.15) {$s_h'$};
\node (FHV) at (2,4.75) { {\color{orangee} fully hidden $s_f \in \mathbb{S}_f$}};
\node[vertex] (fhv) at (6.5,4) {$s_f'$};

\visible<2->{
% visible
\node[vertex] (ov) at (8.5,9.7) {$o_v'$};
\draw[->,>=latex,thick] (vv) to (ov);
\node at (7.5,10) {$s_v'= o_v'$};
}
\visible<3->{
\node (leg1) at (3.5,8.9) {  \color{violet} $\textbf{p} \paren{ s_v' \sachant b_t^{\pi},a } = \sum_{2^{\mathcal{P}(s_v')}} T^a \hspace{-0.04cm} \paren{ \mathcal{P}(s_v'), s_v'} \cdot \overline{b^{\pi}_t} \Big(\mathcal{P}(s_v') \Big).$ };
}
\visible<4->{
\node (leg1) at (2,9.5) { $\Leftrightarrow$ deterministic belief variable. };
}

\visible<5->{
% inférée
\tikzstyle{hvertex}=[circle,fill=black!10,minimum size=20pt,inner sep=0pt]
\node[vertex] (oh) at (8.5,7.15) {$o_i'$};
\draw[->,>=latex,thick] (ihv) to (oh);
\node[hvertex] (sh1) at (6.5,8) {$s_h^{a}$};
\node[hvertex] (sh2) at (6.8,6.2) {$s_h^{b}$};
\node[hvertex] (sh3) at (7.5,5.5) {$s_h^{c}$};
\draw[->,>=latex,thick,dashed] (sh1) to (oh);
\draw[->,>=latex,thick,dashed] (sh2) to (oh);
\draw[->,>=latex,thick,dashed] (sh3) to (oh);
}

\visible<6->{
\node (leg2) at (2,7.3) {$ {\color{gggreen} b^{\pi}_{t+1}(\mathcal{P}(o_i')) }= b^{\pi}_{t+1}(s_h,s_h^a,s_h^b,s_h^c)$};
}
\visible<7->{

\node (leg2) at (3.2,6.4) {$  {\color{gggreen} \propto^{\pi} \pi \Big( o_i', \mathcal{P}(o_i') \Big\vert b^{\pi}_t, a \Big)}.$}; 
%\node (leg2) at (2.5,6.3) { $ \displaystyle \propto^{\pi} \hspace{-0.1cm} \max_{2^{\mathcal{Q}(o_i')}} \hspace{-0.1cm} \Bigg\{ \hspace{-0.1cm} \pi \hspace{-0.05cm} \Big( \hspace{-0.05cm}  o_i', \hspace{-0.05cm}  \mathcal{P}(o_i') \hspace{-0.02cm}  \Big\vert \hspace{-0.02cm}  \mathcal{Q}(o_i'), \hspace{-0.05cm}  a \hspace{-0.05cm}  \Big), \hspace{-0.1cm}  b^{\pi}_t \hspace{-0.1cm}  \Big( \hspace{-0.1cm}  \mathcal{Q}(o_i') \hspace{-0.1cm} \Big) \hspace{-0.1cm}  \Bigg\}$.}; 
}
\visible<8->{
\node (leg2) at (2.5,5.5) { { \color{red} {\fontencoding{U}\fontfamily{futs}\selectfont\char 66\relax}} $\mathcal{P}(o_i')$ may contain visible variables.};
}

\visible<9->{
% inférée
\tikzstyle{hvertex}=[circle,fill=black!10,minimum size=20pt,inner sep=0pt]
\node[vertex] (oh) at (8.5,4) {$o_i'$};
\draw[->,>=latex,thick] (fhv) to (oh);
\node (cross) at (7.5,4) {\includegraphics[scale=0.033]{crossCheck}};
}
\visible<10->{
% inférée
\node (leg3) at (3.3,3.05) { { \color{orangee} $b^{\pi}_{t+1}(s_f') = \displaystyle \max_{2^{\mathcal{P}(s_f')}} \min \bigg\{ \pi \big( s_f'  \big\vert  \mathcal{P}(s_f'), \hspace{-0.1cm} a \big) , b^{\pi}_{t} \big(\mathcal{P}(s_f') \big) \bigg\} $}.};
}
\visible<11->{
\node (leg3) at (2,4.25) {$\rightarrow$ observations don't };
\node (leg3) at (2,3.75) { inform belief state on $s_f'$.};
}
\end{tikzpicture}
\end{frame}



\nico{
%%%%%%%%%%%%%%%%%%%%%%%%%%%%% classification des variables version verticale
\begin{frame}
%\changepage{textheight}{textwidth}{evensidemargin}{oddsidemargin}{columnsep}{topmargin}{headheight}{headsep}{footskip}
%\changepage{}{}{0cm}{0cm}{}{}{}{}{}
\frametitle{Classification des variables}
\framesubtitle{\footnotesize $3$ catégories de variables d'état}%: extension des MOMDPs (Araya-L\'opez, Ong)}
\begin{tikzpicture}
\definecolor{ggreen}{rgb}{0.3,0.7,0.4};
% separations
\node (T1) at (2.1,10.5) {};
\node (B1) at (2.1,3) {};
\draw[thick,dashed,color=black!30] (B1) to (T1);
\node (T2) at (5.9,10.5) {};
\node (B2) at (5.9,3) {};
\draw[thick,color=black!30] (B2) to (T2);

% variables
\tikzstyle{vertex}=[circle,fill=black!30,minimum size=20pt,inner sep=0pt]
\node (V) at (0.1,10.15) {\underline{variable:} {\color{red} visible $\in \mathbb{S}_v$}};
\node[vertex] (vv) at (0.3,9.4) {$s_v'$};
\node (IHV) at (3.9,10.15) { {\color{red} cachée inférée $\in \mathbb{S}_h$}};
\node[vertex] (ihv) at (3.7, 9.4) {$s_h'$};
\node (FHV) at (8,10.15) { {\color{red} complètement cachée}};
\node (FHV2) at (9.2,9.7) {{\color{red}$\in \mathbb{S}_f$}};
\node[vertex] (fhv) at (8,9.4) {$s_f'$};

\visible<2->{
% visible
\node[vertex] (ov) at (0.3,8) {$o_v'$};
\draw[->,>=latex,thick] (vv) to (ov);
\node at (-0.5,8.7) {$s_v'=o_v'$};
}
\visible<3->{
\node (leg1) at (-0.3,7) {$\textbf{p} \paren{ s_v' \sachant b_t,a }$};
\node (leg1) at (0,6) {$= \hspace{-0.3cm} \displaystyle \sum_{2^{\mathcal{P}(s_v')}} \hspace{-0.1cm} T^a \hspace{-0.04cm} \paren{ \hspace{-0.04cm} \mathcal{P}(s_v') \hspace{-0.04cm} , \hspace{-0.06cm} s_v' \hspace{-0.1cm} } \hspace{-0.1cm}$};
\node (leg1) at (0.9,5.6) {$\cdot b_t(\mathcal{P}(s_v')).$};
}
\visible<4->{
\node (leg1) at (0.1,4.8) {$s_v'$ observable};
\node (leg1) at (0.15,4.3) {{\color{ggreen} $\rightarrow$ considérée comme}};
\node (leg1) at (0.15,3.7) {{\color{ggreen}  une variable de}};
\node (leg1) at (0.2,3.1) {{\color{ggreen} croyance déterministe.}};
}


\visible<5->{
% inférée
\tikzstyle{hvertex}=[circle,fill=black!10,minimum size=20pt,inner sep=0pt]
\node[vertex] (oh) at (3.7,8) {$o_i'$};
\draw[->,>=latex,thick] (ihv) to (oh);
\node[hvertex] (sh1) at (2.8,9.4) {$s_h^{a}$};
\node[hvertex] (sh2) at (4.5,9.4) {$s_h^{b}$};
\node[hvertex] (sh3) at (5.3,9.4) {$s_h^{c}$};
\draw[->,>=latex,thick,dashed] (sh1) to (oh);
\draw[->,>=latex,thick,dashed] (sh2) to (oh);
\draw[->,>=latex,thick,dashed] (sh3) to (oh);
}

\visible<6->{
\node (leg2) at (3.2,7) {$ b^{\pi}_{t+1}(\mathcal{P}(o_i'))$};
\node (leg2) at (4.1,6.4) {$= b^{\pi}_{t+1}(s_h,s_h^a,s_h^b,s_h^c)$};
}
\visible<7->{
\node (leg2) at (3.8,5.8) { \footnotesize utilisant $b^{\pi}_t(\mathcal{Q}(o_i'))$ et };
\node (leg2) at (4.1,5.3) { \footnotesize $\pi \paren{ o_i', \mathcal{P}(o_i') \sachant \mathcal{Q}(o_i'), a }$.}; 
}
\visible<8->{
\node (leg2) at (3.5,4.3) { { \color{red} {\fontencoding{U}\fontfamily{futs}\selectfont\char 66\relax}} {\color{ggreen} $\mathcal{P}(o_i')$ peut}};
\node (leg2) at (3.7,3.7) {{\color{ggreen} contenir des}};
\node (leg2) at (4,3.1) {{\color{ggreen} variables visibles.}};
}

\visible<9->{
% inférée
\tikzstyle{hvertex}=[circle,fill=black!10,minimum size=20pt,inner sep=0pt]
\node[vertex] (oh) at (8,8) {$o_i'$};
\draw[->,>=latex,thick] (fhv) to (oh);
\node (cross) at (8,8.75) {\includegraphics[scale=0.033]{crossCheck}};
}
\visible<10->{
% inférée
\node (leg3) at (7.5,7) {$b_{t+1}(s_f') = \displaystyle \max_{2^{\mathcal{P}(s_f')}} $};
\node (leg3) at (7.7,6.2) {$ \displaystyle \min \hspace{-0.1cm} \Big\{ \pi \hspace{-0.04cm} \paren{ s_f' \hspace{-0.04cm} \sachant \hspace{-0.1cm} \mathcal{P}(s_f') \hspace{-0.04cm} , \hspace{-0.1cm} a}$};
\node (leg3) at (8.8,5.6) {$, b^{\pi}_{t} (\mathcal{P}(s_f')) \Big\}.$};
}
\visible<11->{
\node (leg3) at (7.8,4.3) {{\color{ggreen} $\rightarrow$ les observations}};
\node (leg3) at (7.8,3.7) {{\color{ggreen} n'influencent pas}};
\node (leg3) at (8,3.1) {{\color{ggreen} la croyance sur $s_f'$.}};
}
\end{tikzpicture}
\end{frame}

}

\begin{frame}
\frametitle{Possibilistic belief variables}
\framesubtitle{\footnotesize global belief state}
\definecolor{violet}{rgb}{0.7,0.1,0.5}
\definecolor{orangee}{rgb}{1,0.7,0.1}
\definecolor{gggreen}{rgb}{0,0.7,0.7}
\definecolor{bblue}{rgb}{0,0.4,0.75}
$\mathbb{O}_h = \mathbb{O} \setminus \mathbb{S}_v$.
\begin{block}{bound over the global belief state}
$b^{\pi}_{t+1}(\mathbb{S}') = \pi \paren{ \mathbb{S}' \sachant a_0,o_1, \ldots, a_{t},o_{t+1} } $
\end{block}
$ \leqslant \beta_{t+1}(\mathbb{S}')$\\
$\hspace{0.8cm} \displaystyle = \min \hspace{-0.1cm} \Bigg\{ \hspace{-0.1cm} 
{\color{violet} \min_{s_j' \in \mathbb{S}_v} \hspace{-0.1cm} \bigg[ \mathds{1}_{ \set{s_j'=o_j'}} \bigg]} \hspace{-0.1cm}, 
{\color{orangee} \min_{s_j' \in \mathbb{S}_f} \hspace{-0.1cm} \bigg[ b^{\pi}_{t+1}(s_j') \bigg]} \hspace{-0.1cm} , \hspace{-0.1cm} 
{\color{gggreen} \min_{o_i' \in \mathbb{O}_h} \hspace{-0.1cm} \bigg[ b_{t+1}^{\pi} \Big( \hspace{-0.1cm} \mathcal{P}(o_i') 
\hspace{-0.1cm} \Big) \bigg]} \hspace{-0.1cm}  \Bigg\} \hspace{-0.3cm}$\\
\visible<2->{
\vspace{1cm}
\begin{itemize}
\item $\beta_t = $ \textbf{less informative} version of the belief state: 
{\color{red} $b_t^{\pi} \leqslant \beta_t$};
\item computed using \textbf{marginal belief states} $\leftrightarrow$ { \color{red} factorization}.
\end{itemize}
}
%en possibiliste, pas besoin d'enlever les $\mathcal{P}(o_i')$ grâce au min!\\
%The possibilistic normalization, $\forall w \in 2^{\mathcal{P}(o_i')}$,
%$b'(w) = \left \{ \begin{array}{ccc} 1 \mbox{ if } w \in \operatorname*{argmax}_{v \in 2^{\mathcal{P}(o_i')}} \tilde{b}'(v); \\
% \tilde{b}'(w) \mbox{ otherwise} . \end{array} \right.$ 
\end{frame}

\begin{frame}
\definecolor{violet}{rgb}{0.7,0.1,0.5}
\definecolor{orangee}{rgb}{1,0.7,0.1}
\definecolor{gggreen}{rgb}{0,0.7,0.7}
\frametitle{Variables de croyance}
\framesubtitle{\footnotesize different according to the class of the variable}
\definecolor{bblue}{rgb}{0,0.4,0.75}
$\lambda=\# \mathcal{L}$
\visible<2->{
\begin{alertblock}{}
\begin{itemize}
\item {\color{violet} $\forall s'_{v} \in \mathbb{S}_v$, $1$} variable {\color{violet} $\beta'_{v}$} is enough.
\vspace{0.7cm}
\visible<3->{
\item $p_i = \# \mathcal{P}(o_i')$. \\ 
\vspace{0.4cm}
{ \color{gggreen} $ \forall o_i \in \mathbb{O} \setminus \mathbb{S}_v$,}
$\lambda^{2^{p_i}} - (\lambda-1)^{2^{p_i}}$ belief states,\\ 
\vspace{0.3cm}
$\Rightarrow { \color{gggreen} \lceil \log_2(\lambda^{2^{p_i}} - (\lambda-1)^{2^{p_i}}) \rceil}$ boolean variables {\color{gggreen} $\beta_h'$ }.
}
%$\tilde{b}'(\mathcal{P}(o_i')) = \max_{v \in 2^{\mathcal{Q}(o_i')}} \min \set{ \pi \paren{ o_i', \mathcal{P}(o_i') \sachant v,a}, b(v) }$;
\vspace{0.7cm}
\visible<4->{
\item  { \color{orangee} $\forall s'_{f} \in \mathbb{S}_f$,} $\lambda^2 - (\lambda-1)^2 = 2\lambda-1$ belief states,\\ 
\vspace{0.2cm}
$\Rightarrow { \color{orangee} \lceil \log_2(2\lambda-1) \rceil }$ boolean variables {\color{orangee} $\beta_f'$}.
}
\end{itemize}
%where $\pi \paren{ o_i', \mathcal{P}(o'_i) \sachant \mathcal{Q}(o'_i), a }$ 
%$ = \min \set{ \pi \paren{ o_i' \sachant \mathcal{P}(o'_i), a}, \min_{s'_j \in \mathcal{P}(o'_i)} \pi \paren{ s'_j \sachant \mathcal{P}(s'_j), a  } }$.
\end{alertblock}
}
\end{frame}

\begin{frame}
\definecolor{violet}{rgb}{0.7,0.1,0.5}
\definecolor{orangee}{rgb}{1,0.7,0.1}
\definecolor{gggreen}{rgb}{0,0.7,0.7}
\frametitle{resulting MDP in practice}
\framesubtitle{\footnotesize trick: ``flipflop'' variable}

\begin{block}{}
boolean variable ``\textit{flipflop}'' $f$ 
changes state at each time step\\ 
$\rightarrow$ defines $2$ phases:
\begin{enumerate}
\item \textit{observation generation}, 
\item \textit{belief update} (deterministic knowing the observation). 
\end{enumerate}
\end{block}
MDP variables:\\ 
\vspace{0.3cm}
$\tilde{\mathbb{S}} =$ \\
 \textbf{beliefs}: \hspace{-0.2cm} $\beta = { \color{violet} \beta^1_v \hspace{-0.05cm} \times \hspace{-0.05cm} \ldots \hspace{-0.05cm} \times \hspace{-0.05cm} \beta^{m_v}_v } \times  { \color{gggreen} \beta^1_h \hspace{-0.05cm} \times \hspace{-0.05cm} \ldots \hspace{-0.05cm} \times \hspace{-0.05cm} \beta^{m_h}_h } \hspace{-0.07cm} \times { \color{orangee} \beta^1_f \hspace{-0.05cm} \times \hspace{-0.05cm} \ldots \hspace{-0.05cm} \times \hspace{-0.05cm} \beta^{m_f}_f } $ \\
\vspace{0.15cm}
\hspace{2cm} $\times$ \\
$ \begin{array}{c} \mbox{\textbf{visible}} \\ \mbox{\textbf{variables}} \end{array} $: $v = f \times { \color{violet} s^1_v \times \ldots \times s^{m_v}_v } \times o_1 \times \ldots \times o_{k} $.
\end{frame}

\begin{frame}
\definecolor{violet}{rgb}{0.7,0.1,0.5}
\definecolor{orangee}{rgb}{1,0.7,0.1}
\definecolor{gggreen}{rgb}{0,0.7,0.7}
\frametitle{resulting MDP in practice}
\framesubtitle{\footnotesize final structured MDP}
\begin{tikzpicture}[scale=0.88,transform shape]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%TIME/BACKGROUND
\coordinate (middleTop) at (5.7,3);
\coordinate (middleBot) at (5.7,-1.7);
\draw[thick,color=black!20] (middleTop) -- (middleBot);
\node [font=\huge] (statet) at (2,-1) {$t$};
\coordinate (middleTop2) at (11,3);
\coordinate (middleBot2) at (11,-1.7);
\draw[thick,color=black!20] (middleTop2) -- (middleBot2);
\node [font=\huge] (statetplus1) at (7.2,-1) {$t+1$};

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%vertex
%vars
\tikzstyle{vertex}=[circle,fill=black!30,minimum size=25pt,inner sep=0pt]
\tikzstyle{vertex2}=[circle,fill=black!15,minimum size=25pt,inner sep=0pt]
\tikzstyle{vertex3}=[ draw, inner sep=0pt, minimum size=20pt]

%1
\node[vertex] (state1) at (1.5,2.5) {$v_t$};
\node[vertex2] (state12) at (1.5,1) {$\beta_{t-1}$};
%1bis
\node[vertex2] (state1bis) at (4.5,2.5) {$v_t$};
\node[vertex] (state12bis) at (4.5,1) {$\beta_t$};
%R1
\node[vertex3] (R1) at (3.5,-0.5) {$r_t$};

%2
\node[vertex] (state2) at (7,2.5) {$v_{t+1}$};
\node[vertex2] (state22) at (7,1) {$\beta_{t}$};

%2bis
\node[vertex2] (state2bis) at (10,2.5) {$v_{t+1}$};
\node[vertex] (state22bis) at (10,1) {$\beta_{t+1}$};
%R2
\node[vertex3] (R2) at (8.5,-0.5) {$r_{t+1}$};

%0
\node (state02) at (0,1) {};
\node (state03) at (0,2) {};
%3
\node (state3) at (12,2.5) {};
\node (state33) at (12,2) {};
\node (state32) at (12,1) {};
\node (state32bis) at (12,0) {};

%action
\node[fill=black!30] (action) at (5,-1.2) {$a_t$};
\node (action0) at (0,0) {};
\node (action02) at (0,-0.7) {};
\node[fill=black!30] (action3) at (10,-1.2) {$a_{t+1}$};

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%ARROWS
%1->2
\draw[->,>=latex] (state1) -- (state1bis);
\draw[->,>=latex,very thick] (state1) -- (state12bis);
\draw[->,>=latex, very thick] (state12) -- (state12bis);
%1->2bis
\draw[->,>=latex, very thick] (state12bis) -- (state2);
\draw[->,>=latex] (state12bis) -- (state22);
%0->1
\draw[->,>=latex,dashed] (state02) -- (state1);
\draw[->,>=latex,dashed] (state02) -- (state12);
%2->3
\draw[->,>=latex] (state2) -- (state2bis);
\draw[->,>=latex, very thick] (state2) -- (state22bis);
\draw[->,>=latex, very thick] (state22) -- (state22bis);
%2->3bis
\draw[->,>=latex,dashed, very thick] (state22bis) -- (state3);
\draw[->,>=latex,dashed] (state22bis) -- (state32);

%action
%1
\draw[->,>=latex] (action) -- (state2);
\draw[->,>=latex] (action) -- (state22bis);
\draw[->,decorate,decoration={snake,amplitude=.4mm,segment length=2mm,post length=1mm}] (action) -- (R1); 
%0
\draw[->,>=latex,dashed] (action0) -- (state1);
\draw[->,>=latex,dashed] (action02) -- (state12bis);
%3
\draw[->,>=latex,dashed] (action3) -- (state3);
\draw[->,>=latex,dashed] (action3) -- (state32bis);
\draw[->,decorate,decoration={snake,amplitude=.4mm,segment length=2mm,post length=1mm}] (action3) -- (R2); 

% R
\draw[->,decorate,decoration={snake,amplitude=.4mm,segment length=2mm,post length=1mm}] (state12bis) -- (R1); 
\draw[->,decorate,decoration={snake,amplitude=.4mm,segment length=2mm,post length=1mm}] (state22bis) -- (R2); 
\end{tikzpicture}
\vspace{0.3cm}
$\tilde{\mathbb{S}} =$ \\
\vspace{-0.3cm}
\textbf{beliefs}: \hspace{-0.2cm} $\beta = { \color{violet} \beta^1_v \hspace{-0.05cm} \times \hspace{-0.05cm} \ldots \hspace{-0.05cm} \times \hspace{-0.05cm} \beta^{m_v}_v } \times  { \color{gggreen} \beta^1_h \hspace{-0.05cm} \times \hspace{-0.05cm} \ldots \hspace{-0.05cm} \times \hspace{-0.05cm} \beta^{m_h}_h } \hspace{-0.07cm} \times { \color{orangee} \beta^1_f \hspace{-0.05cm} \times \hspace{-0.05cm} \ldots \hspace{-0.05cm} \times \hspace{-0.05cm} \beta^{m_f}_f } $ \\
\vspace{0.15cm}
\hspace{2cm} $\times$ \\
$ \begin{array}{c} \mbox{\textbf{visible}} \\ \mbox{\textbf{variables}} \end{array} $: $v = f \times { \color{violet} s^1_v \times \ldots \times s^{m_v}_v } \times o_1 \times \ldots \times o_{k} $.
\end{frame}

\begin{frame}
\definecolor{violet}{rgb}{0.7,0.1,0.5}
\definecolor{orangee}{rgb}{1,0.7,0.1}
\definecolor{gggreen}{rgb}{0,0.7,0.7}
\frametitle{resulting MDP in practice}
\framesubtitle{\footnotesize final structured MDP }
\begin{tikzpicture}[scale=0.88,transform shape]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%TIME/BACKGROUND
\coordinate (middleTop) at (5.7,3);
\coordinate (middleBot) at (5.7,-1.7);
\draw[thick,color=black!20] (middleTop) -- (middleBot);
\node [font=\huge] (statet) at (2,-1) {$t$};
\coordinate (middleTop2) at (11,3);
\coordinate (middleBot2) at (11,-1.7);
\draw[thick,color=black!20] (middleTop2) -- (middleBot2);
\node [font=\huge] (statetplus1) at (7.2,-1) {$t+1$};

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%vertex
%vars
\tikzstyle{vertex}=[circle,fill=black!30,minimum size=25pt,inner sep=0pt]
\tikzstyle{vertex2}=[circle,fill=black!15,minimum size=25pt,inner sep=0pt]
\tikzstyle{vertex3}=[ draw, inner sep=0pt, minimum size=20pt]

%1
\node[vertex] (state1) at (1.5,2.5) {$v_t$};
\node[vertex2] (state12) at (1.5,1) {$\beta_{t-1}$};
%1bis
\node[vertex2] (state1bis) at (4.5,2.5) {$v_t$};
\node[vertex] (state12bis) at (4.5,1) {$\beta_t$};
%R1
\node[vertex3] (R1) at (3.5,-0.5) {$r_t$};

%2
\node[vertex] (state2) at (7,2.5) {$v_{t+1}$};
\node[vertex2] (state22) at (7,1) {$\beta_{t}$};

%2bis
\node[vertex2] (state2bis) at (10,2.5) {$v_{t+1}$};
\node[vertex] (state22bis) at (10,1) {$\beta_{t+1}$};
%R2
\node[vertex3] (R2) at (8.5,-0.5) {$r_{t+1}$};

%0
\node (state02) at (0,1) {};
\node (state03) at (0,2) {};
%3
\node (state3) at (12,2.5) {};
\node (state33) at (12,2) {};
\node (state32) at (12,1) {};
\node (state32bis) at (12,0) {};

%action
\node[fill=black!30] (action) at (5,-1.2) {$a_t$};
\node (action0) at (0,0) {};
\node (action02) at (0,-0.7) {};
\node[fill=black!30] (action3) at (10,-1.2) {$a_{t+1}$};

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%ARROWS
%1->2
\draw[->,>=latex] (state1) -- (state1bis);
\draw[->,>=latex,very thick] (state1) -- (state12bis);
\draw[->,>=latex, very thick] (state12) -- (state12bis);
%1->2bis
\draw[->,>=latex, very thick] (state12bis) -- (state2);
\draw[->,>=latex] (state12bis) -- (state22);
%0->1
\draw[->,>=latex,dashed] (state02) -- (state1);
\draw[->,>=latex,dashed] (state02) -- (state12);
%2->3
\draw[->,>=latex] (state2) -- (state2bis);
\draw[->,>=latex, very thick] (state2) -- (state22bis);
\draw[->,>=latex, very thick] (state22) -- (state22bis);
%2->3bis
\draw[->,>=latex,dashed, very thick] (state22bis) -- (state3);
\draw[->,>=latex,dashed] (state22bis) -- (state32);

%action
%1
\draw[->,>=latex] (action) -- (state2);
\draw[->,>=latex] (action) -- (state22bis);
\draw[->,decorate,decoration={snake,amplitude=.4mm,segment length=2mm,post length=1mm}] (action) -- (R1); 
%0
\draw[->,>=latex,dashed] (action0) -- (state1);
\draw[->,>=latex,dashed] (action02) -- (state12bis);
%3
\draw[->,>=latex,dashed] (action3) -- (state3);
\draw[->,>=latex,dashed] (action3) -- (state32bis);
\draw[->,decorate,decoration={snake,amplitude=.4mm,segment length=2mm,post length=1mm}] (action3) -- (R2); 

% R
\draw[->,decorate,decoration={snake,amplitude=.4mm,segment length=2mm,post length=1mm}] (state12bis) -- (R1); 
\draw[->,decorate,decoration={snake,amplitude=.4mm,segment length=2mm,post length=1mm}] (state22bis) -- (R2); 
\end{tikzpicture}
\definecolor{violet}{rgb}{0.7,0.1,0.5}
\definecolor{orangee}{rgb}{1,0.7,0.1}
\definecolor{gggreen}{rgb}{0,0.7,0.7}
%$\# \mathbb{S} \cdot \log_2 \paren{ n^{2} } \ll \log_2 \paren{ n^{\# \mathcal{S}} } $
$\#$ \textbf{factorized model}'s variables: $ \# \mathbb{O} \hspace{-0.01cm} + \hspace{-0.01cm} {\color{violet}\#\mathbb{S}_v} +$\\
$\hspace{0.5cm} \displaystyle + {\color{gggreen}\sum_{i=1}^{\# \mathbb{O}_h} \Big\lceil \log_2 \big( \lambda^{2^{p_i}} - (\lambda-1)^{2^{p_i}} \big) \Big\rceil} + {\color{orangee} \# \mathbb{S}_f \cdot \Big\lceil \log_2 \paren{ 2\lambda-1 } \Big\rceil}$ \\
\vspace{0.2cm}
\hspace{0.2cm} { \color{red} $\ll$} \hspace{0.7cm} $\#$ \textbf{initial hybrid model}'s variables: \\
\hspace{5.1cm} $\Big\lceil \log_2 \big( \lambda^{ 2^{\# \mathbb{S}} } - (\lambda-1)^{ 2^{\# \mathbb{S}} } \big) \Big\rceil$\\
\end{frame}

\begin{frame}
\definecolor{violet}{rgb}{0.7,0.1,0.5}
\definecolor{orangee}{rgb}{1,0.7,0.1}
\definecolor{gggreen}{rgb}{0,0.7,0.7}
\frametitle{resulting MDP in practice}
\framesubtitle{\footnotesize final structured MDP}
\begin{tikzpicture}[scale=0.88,transform shape]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%TIME/BACKGROUND
\coordinate (middleTop) at (5.7,3);
\coordinate (middleBot) at (5.7,-1.7);
\draw[thick,color=black!20] (middleTop) -- (middleBot);
\node [font=\huge] (statet) at (2,-1) {$t$};
\coordinate (middleTop2) at (11,3);
\coordinate (middleBot2) at (11,-1.7);
\draw[thick,color=black!20] (middleTop2) -- (middleBot2);
\node [font=\huge] (statetplus1) at (7.2,-1) {$t+1$};

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%vertex
%vars
\tikzstyle{vertex}=[circle,fill=black!30,minimum size=25pt,inner sep=0pt]
\tikzstyle{vertex2}=[circle,fill=black!15,minimum size=25pt,inner sep=0pt]
\tikzstyle{vertex3}=[ draw, inner sep=0pt, minimum size=20pt]

%1
\node[vertex] (state1) at (1.5,2.5) {$v_t$};
\node[vertex2] (state12) at (1.5,1) {$\beta_{t-1}$};
%1bis
\node[vertex2] (state1bis) at (4.5,2.5) {$v_t$};
\node[vertex] (state12bis) at (4.5,1) {$\beta_t$};
%R1
\node[vertex3] (R1) at (3.5,-0.5) {$r_t$};

%2
\node[vertex] (state2) at (7,2.5) {$v_{t+1}$};
\node[vertex2] (state22) at (7,1) {$\beta_{t}$};

%2bis
\node[vertex2] (state2bis) at (10,2.5) {$v_{t+1}$};
\node[vertex] (state22bis) at (10,1) {$\beta_{t+1}$};
%R2
\node[vertex3] (R2) at (8.5,-0.5) {$r_{t+1}$};

%0
\node (state02) at (0,1) {};
\node (state03) at (0,2) {};
%3
\node (state3) at (12,2.5) {};
\node (state33) at (12,2) {};
\node (state32) at (12,1) {};
\node (state32bis) at (12,0) {};

%action
\node[fill=black!30] (action) at (5,-1.2) {$a_t$};
\node (action0) at (0,0) {};
\node (action02) at (0,-0.7) {};
\node[fill=black!30] (action3) at (10,-1.2) {$a_{t+1}$};

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%ARROWS
%1->2
\draw[->,>=latex] (state1) -- (state1bis);
\draw[->,>=latex,very thick] (state1) -- (state12bis);
\draw[->,>=latex, very thick] (state12) -- (state12bis);
%1->2bis
\draw[->,>=latex, very thick] (state12bis) -- (state2);
\draw[->,>=latex] (state12bis) -- (state22);
%0->1
\draw[->,>=latex,dashed] (state02) -- (state1);
\draw[->,>=latex,dashed] (state02) -- (state12);
%2->3
\draw[->,>=latex] (state2) -- (state2bis);
\draw[->,>=latex, very thick] (state2) -- (state22bis);
\draw[->,>=latex, very thick] (state22) -- (state22bis);
%2->3bis
\draw[->,>=latex,dashed, very thick] (state22bis) -- (state3);
\draw[->,>=latex,dashed] (state22bis) -- (state32);

%action
%1
\draw[->,>=latex] (action) -- (state2);
\draw[->,>=latex] (action) -- (state22bis);
\draw[->,decorate,decoration={snake,amplitude=.4mm,segment length=2mm,post length=1mm}] (action) -- (R1); 
%0
\draw[->,>=latex,dashed] (action0) -- (state1);
\draw[->,>=latex,dashed] (action02) -- (state12bis);
%3
\draw[->,>=latex,dashed] (action3) -- (state3);
\draw[->,>=latex,dashed] (action3) -- (state32bis);
\draw[->,decorate,decoration={snake,amplitude=.4mm,segment length=2mm,post length=1mm}] (action3) -- (R2); 

% R
\draw[->,decorate,decoration={snake,amplitude=.4mm,segment length=2mm,post length=1mm}] (state12bis) -- (R1); 
\draw[->,decorate,decoration={snake,amplitude=.4mm,segment length=2mm,post length=1mm}] (state22bis) -- (R2); 
\end{tikzpicture}
\definecolor{violet}{rgb}{0.7,0.1,0.5}
\definecolor{orangee}{rgb}{1,0.7,0.1}
\definecolor{gggreen}{rgb}{0,0.7,0.7}
%$\# \mathbb{S} \cdot \log_2 \paren{ n^{2} } \ll \log_2 \paren{ n^{\# \mathcal{S}} } $
$\#$ \textbf{factorized model}'s variables:\\
\hspace{1cm} $ \leqslant \displaystyle \# \mathbb{O} + { \color{violet} \# \mathbb{S}_v} + { \color{gggreen} \sum_{i=1}^{\# \mathbb{O}_h} \log_2 (\lambda) \cdot 2^{p_i} } + { \color{orangee} \# \mathbb{S}_f \cdot (1 + \log_2(\lambda)) } $ \\
\vspace{0.3cm}
\hspace{0.2cm} { \color{red} $\ll$} \hspace{0.7cm} $\#$ \textbf{initial hybrid model}'s variables: \\
\hspace{5.1cm} $\geqslant \log_2(\lambda) \cdot (2^{\# \mathbb{S}}-1)$.
\end{frame}

\section{Conclusion/Perspectives}
\begin{frame}
\frametitle{Conclusion}
\begin{block}{POMDP $\xrightarrow{ \mbox{\footnotesize \textbf{translation}} }$ MDP with finite state space}
\begin{itemize}
\item transition probabilities on the \textbf{possibilistic belief states};
\visible<2->{
\item \textbf{pessimistic} evaluation of the \textbf{rewards} \\
(Choquet integral);
}
\visible<3->{ 
\item factorized POMDP $\xrightarrow{ \mbox{\footnotesize \textbf{translation}} }$ \textbf{factorized} MPD.
}
\end{itemize}
\end{block}
\visible<4->{
\textbf{perspectives:} 
\begin{itemize}
\item IPPC problems (factorized POMDPs);
\visible<5->{
\item tests of this approach: 
\begin{enumerate}
\item \textbf{simplification:} $\pi$ distributions definition\\
($\pi$-normalization, pignistic transformation,\\ 
most specific, \ldots);
\item \textbf{imprecision:} robust in practice?
\end{enumerate}
}
\end{itemize}
}
\end{frame}

% questions
\frame{
  \vspace{2cm}
  {\huge Thank you!}

}
\end{document}
